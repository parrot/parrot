{"version":1,"ops":[{"type":1,"author":{"id":"aa8915ba52969f979af836ca4704fd27e613004f"},"timestamp":1280101364,"metadata":{"github-id":"MDU6SXNzdWUyODQ4ODA3","github-url":"https://github.com/parrot/parrot/issues/599","origin":"github"},"title":"`NameSpace.add_sub($name, \u0026sub)` does not honor given name for methods","message":"The namespace.add_sub method accepts a name parameter for the sub object.\n\nWhen passed a sub object that has the :method flag set, the given name parameter is ignored in favor of the name compiled into the sub object.\n\n```\n(git:master) ~/kakapo$ cat src/Pmc/test.nqp\nmodule A {\n    method a() { say(\"a\"); }\n\n}\n\nclass B {\n    INIT {\n        my $A := pir::get_hll_namespace__pp( pir::split('::', 'A') );\n        my \u0026a := pir::inspect__pps($A, 'methods')\u003ca\u003e;\n\n        my $B := pir::get_hll_namespace__pp( pir::split('::', 'B') );\n        $B.add_sub('foo', \u0026a);\n    }\n}\n\nmy $b := B.new;\n$b.a;\n$b.foo;(git:master) ~/kakapo$ parrot-nqp src/Pmc/test.nqp \na\nMethod 'foo' not found for invocant of class 'B'\ncurrent instr.: '_block11' pc 95 (EVAL_1:34)\ncalled from Sub 'parrot;HLL;Compiler;_block470' pc 24271 (ext/nqp-rx/src/stage0/HLL-s0.pir:7848)\ncalled from Sub 'parrot;HLL;Compiler;eval' pc 24151 (ext/nqp-rx/src/stage0/HLL-s0.pir:0)\ncalled from Sub 'parrot;PCT;HLLCompiler;evalfiles' pc 1500 (compilers/pct/src/PCT/HLLCompiler.pir:761)\ncalled from Sub 'parrot;PCT;HLLCompiler;command_line' pc 1702 (compilers/pct/src/PCT/HLLCompiler.pir:869)\ncalled from Sub 'parrot;NQP;Compiler;main' pc 88625 (ext/nqp-rx/src/stage0/NQP-s0.pir:24151)\n```\n\nSee in particular the code at [http://trac.parrot.org/parrot/browser/tags/RELEASE_2_6_0/src/pmc/namespace.pmc#L173 namespace.pmc, line 173] which I think is a bug.\n\nOriginally http://trac.parrot.org/parrot/ticket/1718","files":null}]}