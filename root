{"version":1,"ops":[{"type":1,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1413545466,"metadata":{"github-id":"MDU6SXNzdWU0NjA4OTY5OQ==","github-url":"https://github.com/parrot/parrot/issues/1106","origin":"github"},"title":"coroutine return sets return address (one off)","message":"There's still a bug with coro state handling, see `t/pmc/coroutine.t` todo tests 9, 13, 17.\nThis was previously marked as TT 1003, but not handled there.\nThe returncc from the coro sets the wrong continuation.\n\nFor testing you might want to add -t8, e.g. -tc.\n\n```\n$ cat t/pmc/coroutine_13.pir\n.sub 'MyCoro'\n    .yield(1)\n    .yield(2)\n    .return(4)\n.end\n\n.sub 'main' :main\n    $I0 = MyCoro()\n    say $I0\n    $I0 = MyCoro()\n    say $I0\n    $I0 = MyCoro()\n    say $I0\n.end\n```\n\n=\u003e\n\n```\n1\n2\n4\nCannot resume dead coroutine.\n```\n\nor\n$ ./parrot t/pmc/coroutine_17.pir\n\n```\n.sub 'main' :main\n    .const 'Coroutine' $P99 = 'MyCoro'\n    $P99.'autoreset'()\n    $I0 = MyCoro()\n    say $I0\n    $I0 = MyCoro()\n    say $I0\n    $I0 = MyCoro()\n    say $I0\n    $I0 = MyCoro()\n    say $I0\n.end\n.sub 'MyCoro'\n    .yield(1)\n    .yield(2)\n    .return(3)\n.end\n```\n\n=\u003e\n\n```\n1\n2\n3\n1\n2\n3\n1\n2\n```\n\ninstead of \n\n```\n1\n2\n3\n1\n```","files":null}]}