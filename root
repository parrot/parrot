{"version":1,"ops":[{"type":1,"author":{"id":"783ccc49b4a31d108e0fcf9c029db4964b59348d"},"timestamp":1244924880,"metadata":{"github-id":"MDU6SXNzdWUyODQ4NDcw","github-url":"https://github.com/parrot/parrot/issues/273","origin":"github"},"title":"readline_interactive method no longer returns PMCNULL on eof","message":"Sending EOF to the standard input (typically: hitting Control-G) does not make HLLCompiler end interactive sessions when readline is used.\n\nTo reproduce: take your favorite HLL written with HLLCompiler, and a Parrot with readline, and run it without any argument. This should start an interactive session (i.e., you get a prompt for the language), but hitting \n\n``` ^G```\n makes HLLCompiler display a new prompt instead of exiting.\n\nThis bug has two origins:\n\n* the \"readline_interactive\" method of FileHandle always returns a string (that's because of its type: when it seems to return NULL, it is actually converted to the empty string). On the other hand, HLLCompiler tests if the value returned by \"readline_interactive\" is null to detect EOF: this test is always false... The fix is to test EOF using the \"get_bool\" vtable of FileHandle; and\n\n* the method \"readline_interactive\" never sets the EOF flag when readline is activated.\n\nThe attached patch fixes this.\n\nOriginally http://trac.parrot.org/parrot/ticket/760\n```","files":null}]}