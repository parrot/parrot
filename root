{"version":1,"ops":[{"type":1,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1354823795,"metadata":{"github-id":"MDU6SXNzdWU5MDY1Njc5","github-url":"https://github.com/parrot/parrot/issues/875","origin":"github"},"title":"threads and -t1:  gc_gms_mark_pmc_header: self-\u003ework_list might be empty","message":"The grey marker might need an additional checker:\ngc_gms_mark_pmc_header: self-\u003ework_list might be empty\n\nI can repro it with `parrot -t1` on something large, like\n`gdb --args ./parrot -t1 runtime/parrot/library/nqp-rx.pbc ext/nqp-rx/t/nqp/67-threads.t`\n\nand I fixed it with:\n\n```\ndiff --git a/src/gc/gc_gms.c b/src/gc/gc_gms.c\nindex 946230b..8ca765f 100644\n--- a/src/gc/gc_gms.c\n+++ b/src/gc/gc_gms.c\n@@ -1213,8 +1213,10 @@ gc_gms_mark_pmc_header(PARROT_INTERP, ARGMOD(PMC *pmc))\n     /* mark it live. */\n     PObj_live_SET(pmc);\n\n-    Parrot_pa_remove(interp, self-\u003eobjects[gen], item-\u003eptr);\n-    item-\u003eptr = Parrot_pa_insert(self-\u003ework_list, item);\n+    if (self-\u003ework_list) {\n+        Parrot_pa_remove(interp, self-\u003eobjects[gen], item-\u003eptr);\n+        item-\u003eptr = Parrot_pa_insert(self-\u003ework_list, item);\n+    }\n }\n```","files":null}]}