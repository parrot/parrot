{"version":1,"ops":[{"type":1,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1418808222,"metadata":{"github-id":"MDU6SXNzdWU1MjIxNzU0Mw==","github-url":"https://github.com/parrot/parrot/issues/1161","origin":"github"},"title":"nqp::savecapture: CallContext.get_number missing","message":"Disable the skip parrot in t/nqp/76-capture.t:\n\n```\n$ ./nqp-p t/nqp/76-capture.t \n1..4\nok 1 - nqp::captureposelems on result of usecapture\nok 2 - nqp::captureposarg on result of usecapture\nget_number() not implemented in class 'CallContext'\ncurrent instr.: '\u003cmainline\u003e' pc 136 ((file unknown):71) (t/nqp/76-capture.t:23)\ncalled from Sub 'eval' pc 28016 (gen/parrot/stage2/NQPHLL.pir:10770) (gen/parrot/stage2/NQPHLL.nqp:1178)\ncalled from Sub 'evalfiles' pc 30899 (gen/parrot/stage2/NQPHLL.pir:11969) (gen/parrot/stage2/NQPHLL.nqp:1372)\ncalled from Sub 'command_eval' pc 29902 (gen/parrot/stage2/NQPHLL.pir:11576) (gen/parrot/stage2/NQPHLL.nqp:1302)\ncalled from Sub 'command_line' pc 28780 (gen/parrot/stage2/NQPHLL.pir:11130) (gen/parrot/stage2/NQPHLL.nqp:1250)\ncalled from Sub 'MAIN' pc 601 (gen/parrot/stage2/NQP.pir:203) (gen/parrot/stage2/NQP.nqp:4046)\ncalled from Sub '\u003cmainline\u003e' pc 578 (gen/parrot/stage2/NQP.pir:191) (gen/parrot/stage2/NQP.nqp:4041)\ncalled from Sub '' pc 165114 (gen/parrot/stage2/NQP.pir:58010) (gen/parrot/stage2/NQP.nqp:4018)\n```\n\nnqp wants to set the callcontext from `nqp::savecapture` to a N, and not a P register. It fails in `set_n_p nreg, callcontext`. It should use `set_p_p` instead. But I have no idea yet, where set_n_p is called. It is not the op in the body savecapture, but probably the arg to savecapture","files":null}]}