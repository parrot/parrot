{"version":1,"ops":[{"type":1,"author":{"id":"6d59fc378929d99368e023bcfc49aacae1e68aad"},"timestamp":1311728212,"metadata":{"github-id":"MDU6SXNzdWUyODQ4Njk5","github-url":"https://github.com/parrot/parrot/issues/491","origin":"github"},"title":"Error detecting attributes (g++-3.3)","message":"```\nI'm forwarding this to Trac so it doesn't get lost.  The original problem \nmanifested itself on the openbsd smoker in the gcc compile farm, but is \nlikely more general than that.\n\n-- \n    Andy Dougherty      doughera@lafayette.edu\n\n---------- Forwarded message ----------\nDate: Mon, 25 Jul 2011 19:53:31 -0400 (EDT)\nFrom: Andy Dougherty \u003cdoughera@lafayette.edu\u003e\nTo: Jonathan \"Duke\" Leto \u003cjonathan@leto.net\u003e\nCc: parrot-dev \u003cparrot-dev@lists.parrot.org\u003e\nSubject: Re: compile error on openbsd with g++\n\nOn Sat, 23 Jul 2011, Andy Dougherty wrote:\n\n\u003e On Fri, 22 Jul 2011, Jonathan \"Duke\" Leto wrote:\n\u003e \n\u003e \u003e gcc (GCC) 3.3.5 (propolice)\n\n\u003e \u003e On Fri, Jul 22, 2011 at 10:49 AM, Jonathan \"Duke\" Leto\n\u003e \u003e \u003cjonathan@leto.net\u003e wrote:\n\u003e \u003e \u003e Howdy,\n\u003e \u003e \u003e\n\u003e \u003e \u003e Just got the openbsd smoker in the farm working again, and it hit a\n\u003e \u003e \u003e compile error:\n\u003e \u003e \u003e\n\u003e \u003e \u003e https://gist.github.com/1099956\n\u003e \n\u003e Without seeing both the output of Configure.pl --verbose and the \n\u003e preprocessed output of src/string/api.c, it's hard to be sure, but this \n\u003e looks like the sort of thing you get when parrot's detection of attributes \n\u003e is wrong.\n\u003e \n\u003e In particular, the gcc-3.3/HASATTRIBUTE_UNUSED combination is tricky:  It \n\u003e works in gcc-3.3, but fails in g++-3.3.\n\nI haven't tested this at all, but I suspect that the issue is that the \nConfigure.pl probe doesn't use the attribute in the same way as parrot \ndoes.  (The inline probe has the same problem.  See TT #1943).\n\nIt's likely that a rather trivial patch like the one below will fix this \nimmediate problem, but since my last 2 attempts to do something useful for \nattribute detection were rejected, I'm unwilling to work any harder at it.\n\ndiff --git a/config/auto/attributes/test_c.in b/config/auto/attributes/test_c.in\nindex eb5262c..896da8b 100644\n--- a/config/auto/attributes/test_c.in\n+++ b/config/auto/attributes/test_c.in\n@@ -42,7 +42,7 @@ coldfunc(int x);\n\n\n static int\n-useless(void) { int x __attribute__unused__; return 0; }\n+useless(int x __attribute__unused__) { int y __attribute__unused__; return 0; }\n\n\n /* as long as the file compiles, everything is okay */\n\n\n\n-- \n    Andy Dougherty      doughera@lafayette.edu\n\n```\n\nOriginally http://trac.parrot.org/parrot/ticket/2164","files":null}]}