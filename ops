{"version":1,"ops":[{"type":3,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1415631673,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYyMzk1NTM5","github-url":"https://github.com/parrot/parrot/issues/1129#issuecomment-62395539"},"message":"The corresponding parrot bug is 1. a missing lstat method in `io.ops`, and 2. the wrong lstat call in `src/pmc/os.pmc`.\n\nThe nqp fix is\n\n```\n--- src/vm/parrot/QAST/Operations.nqp\n+++ src/vm/parrot/QAST/Operations.nqp\n@@ -1653,6 +1653,7 @@ QAST::Operations.add_core_pirop_mapping('associative_bind', 'set', '1QsP', :inli\n QAST::Operations.add_core_pirop_mapping('print', 'print', '0s', :inlinable(1));\n QAST::Operations.add_core_pirop_mapping('say', 'say', '0s', :inlinable(1));\n QAST::Operations.add_core_pirop_mapping('stat', 'stat', 'Isi', :inlinable(1));\n+QAST::Operations.add_core_pirop_mapping('lstat', 'lstat', 'Isi', :inlinable(1));\n QAST::Operations.add_core_pirop_mapping('open', 'open', 'Pss', :inlinable(1));\n--- t/nqp/19-file-ops.t\n+++ t/nqp/19-file-ops.t\n@@ -184,12 +185,13 @@ else {\n     nqp::closefh($fh);\n     nqp::symlink($test-file, $test-file ~ '-symlink');\n     ok(nqp::stat($test-file ~ '-symlink', nqp::const::STAT_EXISTS), 'the symbolic link should exist');\n-    if nqp::getcomp('nqp').backend.name eq 'parrot' {\n-        ok(1, 'ok 45 # Skipped: stat + STAT_ISLNK is broken on parrot');\n+    if nqp::getcomp('nqp').backend.name eq 'parrot' { # see parrot #1129\n+        ok(nqp::lstat($test-file ~ '-symlink', nqp::const::STAT_ISLNK), 'the symbolic link should actually *be*\n     }\n     else {\n+        # moar and jvm use non-POSIX semantics\n         ok(nqp::stat($test-file ~ '-symlink', nqp::const::STAT_ISLNK), 'the symbolic link should actually *be* a\n     }\n```","files":null},{"type":2,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1415631721,"metadata":{"github-id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50MTkwODEzMzg2"},"title":"missing lstat for nqp","was":"missing lstat for nqp"},{"type":4,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1415636864,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50MTkwODcxMTM5"},"status":2}]}