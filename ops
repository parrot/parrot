{"version":1,"ops":[{"type":1,"author":{"id":"0c9c62332064205b2d799407019fa3e7e2f43862"},"timestamp":1348852406,"metadata":{"github-id":"MDU6SXNzdWU3MjIzMzQ0","github-url":"https://github.com/parrot/parrot/issues/848","origin":"github"},"title":"'bands' and 'bors' opcodes don't work on utf8 and ucs4 strings","message":"The 'bands' and 'bors' opcodes throw an exception when handed utf8 or ucs4 strings.\n\nTest program:\n\n```\npmichaud@kiwi:~/p6/parrot$ cat bws1.pir\n.loadlib 'bit_ops'\n\n.sub 'main' :main\n\n    say 'ascii:'\n    'bitwise_test'(     ascii:\"hello\", \"oaooo\")\n\n    say 'iso-8859-1:'\n    'bitwise_test'(iso-8859-1:\"hello\", \"oaooo\")\n\n    say 'utf8:'\n    'bitwise_test'(      utf8:\"hello\", \"oaooo\")\n\n    say 'ucs4:'\n    'bitwise_test'(      ucs4:\"hello\", \"oaooo\")\n.end\n\n.sub 'bitwise_test'\n    .param string a\n    .param string b\n    $S1 = bands a, b\n    print a\n    print \" ~\u0026 \"\n    print b\n    print \" = \"\n    say $S1\n    $S1 = bors a, b\n    print a\n    print \" ~| \"\n    print b\n    print \" = \"\n    say $S1\n    say ''\n.end\n\npmichaud@kiwi:~/p6/parrot$ ./parrot bws1.pir\nascii:\nhello ~\u0026 oaooo = hallo\nhello ~| oaooo = oeooo\n\niso-8859-1:\nhello ~\u0026 oaooo = hallo\nhello ~| oaooo = oeooo\n\nutf8:\nstring bitwise_and (utf8/ascii) unsupported\ncurrent instr.: 'bitwise_test' pc 59 (bws1.pir:21)\ncalled from Sub 'main' pc 37 (bws1.pir:12)\npmichaud@kiwi:~/p6/parrot$ \n```\n\nI would expect the utf8: and ucs4: encodings to produce the same results as ascii and iso-8859-1.\n\nFor the case of strings with codepoints larger than 256, Perl 6 would like the opcodes to return the string that results from doing integer-and / integer-or of the codepoints of the operands.\n\nPm","files":null}]}