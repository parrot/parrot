{"version":1,"ops":[{"type":2,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1422795868,"metadata":{"github-id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50MjI4MTI3ODI1"},"title":"Fix --gc ms: winxed.pbc -c --noan tools/dev/pbc_to_exe.winxed","was":"Fix --gc ms SEGV with winxed.pbc -c --noan tools/dev/pbc_to_exe.winxed"},{"type":2,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1422795877,"metadata":{"github-id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50MjI4MTI3ODMy"},"title":"Fix --gc ms SEGV with winxed.pbc -c --noan tools/dev/pbc_to_exe.winxed","was":"Fix --gc ms: winxed.pbc -c --noan tools/dev/pbc_to_exe.winxed"},{"type":5,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1422795883,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDIyODEyNzg0Mg=="},"added":["Component-GC"],"removed":[]},{"type":5,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1422795888,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDIyODEyNzg0NA=="},"added":["Optimization"],"removed":[]},{"type":5,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1422795891,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDIyODEyNzg0Nw=="},"added":["Pri-major"],"removed":[]},{"type":3,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1422816295,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDcyMzc3NTYz","github-url":"https://github.com/parrot/parrot/issues/1196#issuecomment-72377563"},"message":"Found and fixed the/one? problem for ms and ms2:\nWhen certain functions cause a GC, the string buffers may get moved away in the final compact phase, \nbut local STRING\\* variables or stringhandles like PMC *handle may still point to the old location.\nEsp. IO likes to enhance the stringhandle it writes to or the result buffer when it reads.\n\nE.g. in `Parrot_io_write_s()` for `PMC * handle-\u003estringhandle`. \n\nPossible fixes:\n- Lock the whole GC in those cases (we have `Parrot_block_GC_mark` for this)\n- Lock the compact phase only, we can call `Parrot_block_GC_sweep` but would need a _move lock_ only. Thus would be needed for a copying GC also.\n- Unset one of `PObj_is_movable` flags in the STRING that it may not be moved, \n  as it is still locally referenced.","files":null},{"type":4,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1445293176,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50NDM5NzAwODYw"},"status":2}]}