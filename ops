{"version":1,"ops":[{"type":3,"author":{"id":"aeaa659130ab92a2084a11638a6eb1a6beb03360"},"timestamp":1293806930,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDMzNTg=","github-url":"https://github.com/parrot/parrot/issues/489#issuecomment-3503358"},"message":"\u003cp\u003e\nThe serialization code is baroque and hard to wrap one's head around, but it won't be especially helpful to our users to deprecate the current system before a feasible replacement is in place.  Could you spell out the changes you're suggesting and how existing code will be effected?\n\u003c/p\u003e","files":null},{"type":3,"author":{"id":"aef4977f5ea786238d7c9581a2f192f4adc3f39d"},"timestamp":1293830679,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDMzNTk=","github-url":"https://github.com/parrot/parrot/issues/489#issuecomment-3503359"},"message":"\u003cp\u003e\nnot counting the generated code in src/extend_vtable.c, the vtables freeze, thaw, thawfinish, and visit are all called exactly once: in src/packfile/object_serialization.c:Parrot_visit_loop_visit. Here's the relevant snippet, with some details removed:\n\u003c/p\u003e\n\n\u003cpre class=\"wiki\"\u003econst INTVAL action = VTABLE_get_integer(interp, info);\n...\nif (action == VISIT_FREEZE_NORMAL)\n    VTABLE_freeze(interp, current, info);\nelse\n    VTABLE_thaw(interp, current, info);\nVTABLE_visit(interp, current, info);\n\u003c/pre\u003e\u003cp\u003e\nWhat I am suggesting we do is to move the logic from VTABLE_thaw and VTABLE_freeze into VTABLE_visit. We have all the information in the info PMC that we need to select the appropriate behaviors. This is also a process that we could complete gradually: We can move logic out of VTABLE_freeze and VTABLE_thaw gradually without breaking anything, and when we're done we eliminate two vtables.\n\u003c/p\u003e","files":null},{"type":3,"author":{"id":"d9b4aee65ce8c18d4a43eced1eecb0d154e1eebb"},"timestamp":1314490109,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDMzNjA=","github-url":"https://github.com/parrot/parrot/issues/489#issuecomment-3503360"},"message":"\u003cp\u003e\ncotto, whiteknight:\n\u003c/p\u003e\n\n\u003cp\u003e\nCan we get an update on the status of this ticket?\n\u003c/p\u003e\n\n\u003cp\u003e\nThank you very much.\n\u003c/p\u003e\n\n\u003cp\u003e\nkid51\n\u003c/p\u003e","files":null}]}