{"version":1,"ops":[{"type":1,"author":{"id":"d9b4aee65ce8c18d4a43eced1eecb0d154e1eebb"},"timestamp":1338136795,"metadata":{"github-id":"MDU6SXNzdWU0NzcxOTMz","github-url":"https://github.com/parrot/parrot/issues/776","origin":"github"},"title":"t/compilers/imcc/syn/clash.t: FAILs under 'make testr' on some machines but not others","message":"This bug report falls into the maddening category of \"I get it on one machine, but not on another very similar machine.\"\n\nOn my Linode, which I have used for testing Parrot for going on six years, I now get one, previously unseen failure in one test file in just one of the alternate runcores exercised by 'make fulltest'.  But I do _not_ get this error on a different Linux machine on which I have also tested Parrot many, many times.\n\nThe failure occurs in the `make testr` part of `make fulltest` or `make smolder_fulltest`.  Specifically, in happens in test #11 of `t/compilers/imcc/syn/clash.t`.\n\n``` perl\nt/compilers/imcc/syn/clash.t ........ 1/13 \nnot ok 9 - new with a native type, no string constant # TODO GH #335 not done yet\n\n#   Failed test 'undefined ident'\n#   at t/compilers/imcc/syn/clash.t line 192.\n# Expected error but exited cleanly\n# Received:\n# error:imcc:undefined identifier 'no_such'\n# \n#       in file '/home/jimk/gitwork/parrot/t/compilers/imcc/syn/clash_11.pir' line 2\n# ok\n# \n# Expected:\n# /error.*undefined.*'no_such'/\n# \nt/compilers/imcc/syn/clash.t ........ 13/13 # Looks like you failed 1 test of 13.\nt/compilers/imcc/syn/clash.t ........ Dubious, test returned 1 (wstat 256, 0x100)\nFailed 1/13 subtests \n```\n\nI can consistently reproduce this error outside the context of `make testr` by saying:\n\n```\nperl t/harness -r t/compilers/imcc/syn/clash.t\n```\n\nHowever, when I run `make testr`, `make fulltest` or `perl t/harness -r t/compilers/imcc/syn/clash.t` on the other Linux box I never get the error.  There, I get:\n\n``` perl\n$ HARNESS_VERBOSE=1\n$ export HARNESS_VERBOSE\n$  perl t/harness -r t/compilers/imcc/syn/clash.t\nt/compilers/imcc/syn/clash.t .. \n1..13\nok 1 - if/unless\nok 2 - if/unless\nok 3 - new\nok 4 - clone\nok 5 - defined\nok 6 - defined keyed\nok 7 - parrot op as identifier\nok 8 - parrot op as label\nnot ok 9 - new with a native type, no string constant # TODO GH #335 not done yet\n\n#   Failed (TODO) test 'new with a native type, no string constant'\n#   at t/compilers/imcc/syn/clash.t line 172.\n#                   'error:imcc:The opcode 'new_p_ic' (new\u003c2\u003e) was not found. Check the type and number of the arguments\n#   in file '/home/jkeenan/gitwork/parrot/t/compilers/imcc/syn/clash_9.pir' line 2\n# Can't stat t/compilers/imcc/syn/clash_9.pbc, code 2.\n# \n# current instr.: '__default_get_packfile' pc 435 (frontend/parrot2/prt0.pir:158)\n# '\n#     doesn't match '/error:imcc:syntax error, unexpected IDENTIFIER \\('INTVAL'\\)/\n# '\n# 'ARRAY(0x83f3cb8)' failed with exit code 1\nok 10 - new with an unknown class\nok 11 - undefined ident\nok 12 - label ident\nok 13 - lexical redeclared in sub\nok\nAll tests successful.\nFiles=1, Tests=13,  1 wallclock secs ( 0.03 usr  0.00 sys +  0.18 cusr  0.14 csys =  0.35 CPU)\nResult: PASS\n```\n\nBoth machines are Linux i686.  Both were recently upgrade to Perl 5.16.0 and hence, I am using the same version of `prove` and the underlying `TAP::*` modules on both.  On the Linode, I use gcc 4.3.2, as I have for several years.  On the other machine (which is whatever is latest Ubuntu long-term-stable), I use gcc 4.4.1.\n\nI tried manually bisecting.  It appears that the `make testr` error first appeared on my Linode here:\n\n```\n$ git show 0083dc25e244\ncommit 0083dc25e24468a7d1bb70b03a813e21b392154a\nMerge: 95c9a63... 5bdacd5...\nAuthor: Whiteknight \u003cwknight8111@gmail.com\u003e\nDate:   Wed May 16 21:06:29 2012 -0400\n\n    Merge branch 'whiteknight/imcc_file_line'\n```\n\nCan anyone help?  Thank you very much.\n\nJim Keenan","files":null}]}