{"version":1,"ops":[{"type":3,"author":{"id":"d9b4aee65ce8c18d4a43eced1eecb0d154e1eebb"},"timestamp":1355670384,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDExNDE4NTcz","github-url":"https://github.com/parrot/parrot/issues/887#issuecomment-11418573"},"message":"I should note that the above output was observed on Darwin/x86_64.","files":null},{"type":3,"author":{"id":"d9b4aee65ce8c18d4a43eced1eecb0d154e1eebb"},"timestamp":1355671471,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDExNDE4NzQz","github-url":"https://github.com/parrot/parrot/issues/887#issuecomment-11418743"},"message":"Failures in the same tests, but with different output, on Linux/i386:\n\n```\n#   Failed test 'magic string 0xfePBC0x0a0x1a0x0a len=7'\n#   at t/native_pbc/header.t line 65.\n#          got: 'error:i'\n#     expected: '?PBC\n# \n# '\n\n#   Failed test 'wordsize: 109'\n#   at t/native_pbc/header.t line 66.\n\n#   Failed test 'byteorder: 99'\n#   at t/native_pbc/header.t line 67.\n\n#   Failed test 'floattype: 99'\n#   at t/native_pbc/header.t line 68.\n\n#   Failed test 'major version: 58 vs 4'\n#   at t/native_pbc/header.t line 69.\n#          got: '58'\n#     expected: '4'\n\n#   Failed test 'minor version: 115 vs 10'\n#   at t/native_pbc/header.t line 70.\n#          got: '115'\n#     expected: '10'\n\n#   Failed test 'patch version: 121 vs 0'\n#   at t/native_pbc/header.t line 71.\n#          got: '121'\n#     expected: '0'\n# Looks like you failed 7 tests of 9.\ntestr__t/native_pbc/header.t ............... Dubious, test returned 7 (wstat 1792, 0x700)\nFailed 7/9 subtests \n===(    7035;76  10/25  41/78  11/17  1/4 )=============================\n#   Failed test '4_be=\u003e4_le big-endian 32 bit opcode_t, 4 byte intval, 8 byte double'\n#   at t/native_pbc/Test.pm line 114.\n# PackFile_unpack: Dir format was 16777216 not 1\n# \n# current instr.: '__default_get_packfile' pc 435 (frontend/parrot2/prt0.pir:158)\n# \n\n#   Failed test '8_le=\u003e4_le x86_64 64 bit opcode_t, 8 byte intval, 8 byte double'\n#   at t/native_pbc/Test.pm line 114.\n# Failed allocation of 3099447676 bytes\n# Parrot VM: PANIC: Out of mem!\n# C file src/gc/gc_gms.c, line 1950\n# Parrot file (not available), line (not available)\n# \n# We highly suggest you notify the Parrot team if you have not been working on\n# Parrot.  Use parrotbug (located in parrot's root directory) or send an\n# e-mail to parrot-dev@lists.parrot.org.\n# Include the entire text of this error message and the text of the script that\n# generated the error.  If you've made any modifications to Parrot, please\n# describe them as well.\n# \n# Version     : 4.10.0-devel\n# Configured  : Sun Dec 16 14:58:42 2012 GMT\n# Architecture: i386-linux\n# Interp Flags: (no interpreter)\n# Exceptions  : (missing from core)\n# \n# Dumping Core...\n# Sorry, coredump is not yet implemented for this platform.\n# \n# \n# Looks like you failed 2 tests of 4.\ntestr__t/native_pbc/integer.t .............. Dubious, test returned 2 (wstat 512, 0x200)\nFailed 2/4 subtests \n        (less 1 skipped subtest: 1 okay)\n===(    7047;76  10/25  49/78  11/17  1/7 )=============================\n#   Failed test '4_12_le=\u003e4_8_le i386 32 bit opcode_t, 4 byte intval, 12 byte long double'\n#   at t/native_pbc/Test.pm line 114.\n# Invalid character in ASCII string\n# current instr.: '__default_get_packfile' pc 435 (frontend/parrot2/prt0.pir:158)\n# \n\n#   Failed test '4_8_be=\u003e4_8_le big-endian 32 bit opcode_t, 4 byte intval, 8 byte double'\n#   at t/native_pbc/Test.pm line 114.\n# PackFile_unpack: Dir format was 16777216 not 1\n# \n# current instr.: '__default_get_packfile' pc 435 (frontend/parrot2/prt0.pir:158)\n# \n\n#   Failed test '8_8_le=\u003e4_8_le x86_64 64 bit opcode_t, 8 byte intval, 8 byte double'\n#   at t/native_pbc/Test.pm line 114.\n# Failed allocation of 3099447676 bytes\n# Parrot VM: PANIC: Out of mem!\n# C file src/gc/gc_gms.c, line 1950\n# Parrot file (not available), line (not available)\n# \n# We highly suggest you notify the Parrot team if you have not been working on\n# Parrot.  Use parrotbug (located in parrot's root directory) or send an\n# e-mail to parrot-dev@lists.parrot.org.\n# Include the entire text of this error message and the text of the script that\n# generated the error.  If you've made any modifications to Parrot, please\n# describe them as well.\n# \n# Version     : 4.10.0-devel\n# Configured  : Sun Dec 16 14:58:42 2012 GMT\n# Architecture: i386-linux\n# Interp Flags: (no interpreter)\n# Exceptions  : (missing from core)\n# \n# Dumping Core...\n# Sorry, coredump is not yet implemented for this platform.\n# \n# \n# Looks like you failed 3 tests of 7.\ntestr__t/native_pbc/number.t ............... Dubious, test returned 3 (wstat 768, 0x300)\nFailed 3/7 subtests \n        (less 3 skipped subtests: 1 okay)\n===(    7061;76  10/25  56/78  11/17  1/4 )=============================\n#   Failed test '4_be=\u003e4_le big-endian 32 bit opcode_t, 4 byte intval'\n#   at t/native_pbc/Test.pm line 114.\n# PackFile_unpack: Dir format was 16777216 not 1\n# \n# current instr.: '__default_get_packfile' pc 435 (frontend/parrot2/prt0.pir:158)\n# \n\n#   Failed test '8_le=\u003e4_le x86_64 64 bit opcode_t, 8 byte intval'\n#   at t/native_pbc/Test.pm line 114.\n# Failed allocation of 3099447676 bytes\n# Parrot VM: PANIC: Out of mem!\n# C file src/gc/gc_gms.c, line 1950\n# Parrot file (not available), line (not available)\n# \n# We highly suggest you notify the Parrot team if you have not been working on\n# Parrot.  Use parrotbug (located in parrot's root directory) or send an\n# e-mail to parrot-dev@lists.parrot.org.\n# Include the entire text of this error message and the text of the script that\n# generated the error.  If you've made any modifications to Parrot, please\n# describe them as well.\n# \n# Version     : 4.10.0-devel\n# Configured  : Sun Dec 16 14:58:42 2012 GMT\n# Architecture: i386-linux\n# Interp Flags: (no interpreter)\n# Exceptions  : (missing from core)\n# \n# Dumping Core...\n# Sorry, coredump is not yet implemented for this platform.\n# \n# \n# Looks like you failed 2 tests of 4.\ntestr__t/native_pbc/string.t ............... Dubious, test returned 2 (wstat 512, 0x200)\nFailed 2/4 subtests \n        (less 1 skipped subtest: 1 okay)\ntestr__t/pmc/sub.t ......................... ok                         \n[snip]\nTest Summary Report\n-------------------\ntestr__t/native_pbc/header.t                     (Wstat: 1792 Tests: 9 Failed: 7)\n  Failed tests:  1-7\n  Non-zero exit status: 7\ntestr__t/native_pbc/integer.t                    (Wstat: 512 Tests: 4 Failed: 2)\n  Failed tests:  2-3\n  Non-zero exit status: 2\ntestr__t/native_pbc/number.t                     (Wstat: 768 Tests: 7 Failed: 3)\n  Failed tests:  2-4\n  Non-zero exit status: 3\ntestr__t/native_pbc/string.t                     (Wstat: 512 Tests: 4 Failed: 2)\n  Failed tests:  2-3\n  Non-zero exit status: 2\nFiles=884, Tests=33075, 625 wallclock secs ( 7.75 usr  2.30 sys + 849.68 cusr 85.11 csys = 944.84 CPU)\nResult: FAIL\nmake: *** [fulltest] Error 1\n```","files":null},{"type":3,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1355671739,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDExNDE4Nzkw","github-url":"https://github.com/parrot/parrot/issues/887#issuecomment-11418790"},"message":"This looks like the typical darwin missing rpath/DYLD_LIBRARY_PATH problem, \nwhen darwin picks up the wrong(older) installed libparrot.dylib.\nI tested without DYLD_LIBRARY_PATH being set, but with a correct libparrot.dylib installed.\n\n```\n$ unset DYLD_LIBRARY_PATH\n$ export DYLD_LIBRARY_PATH\n$ perl t/harness t/native_pbc/*.t\nt/native_pbc/header.t ... ok   \nt/native_pbc/integer.t .. 1/4 \nok 4 # skip t/native_pbc/integer_8_be.pbc has old PBC_COMPAT 4.0. Need 8_be platform to generate it.\nt/native_pbc/integer.t .. ok   \nt/native_pbc/number.t ... 1/7 \nok 6 # skip t/native_pbc/number_8_8_be.pbc has old PBC_COMPAT 4.0. Need 8_8_be platform to generate it.\nok 7 # skip t/native_pbc/number_8_16_be.pbc has old PBC_COMPAT 4.0. Need 8_16_be platform to generate it.\nt/native_pbc/number.t ... ok   \nt/native_pbc/string.t ... 1/4 \nok 4 # skip t/native_pbc/string_8_be.pbc has old PBC_COMPAT 4.0. Need 8_be platform to generate it.\nt/native_pbc/string.t ... ok   \nAll tests successful.\nFiles=4, Tests=24,  0 wallclock secs ( 0.03 usr  0.01 sys +  0.31 cusr  0.21 csys =  0.56 CPU)\nResult: PASS\n```\n\nWith an old libparrot being installed I can reproduce your errors. \nSo I'll set DYLD_LIBRARY_PATH","files":null},{"type":3,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1355680870,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDExNDIwNTIx","github-url":"https://github.com/parrot/parrot/issues/887#issuecomment-11420521"},"message":"You want to keep old (possibly wrong) settings? You'll get it. Yes, it's friendlier.\nThis scenario involves DYLD_LIBRARY_PATH required for some libparrot dependency in a non default location (ice, pcre, ...).","files":null},{"type":3,"author":{"id":"d9b4aee65ce8c18d4a43eced1eecb0d154e1eebb"},"timestamp":1355753486,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDExNDQyODEy","github-url":"https://github.com/parrot/parrot/issues/887#issuecomment-11442812"},"message":"If I'm getting errors in the same files on Linux as well as Darwin, that suggests that the problem cannot be reduced to DYLD_LIBRARY_PATH.","files":null},{"type":3,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1355863667,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDExNTA0MzUx","github-url":"https://github.com/parrot/parrot/issues/887#issuecomment-11504351"},"message":"testr is the second problem.\nI already had fixed it in my old native_pbc branch, but it obviously got lost while rebasing.\nI'll check again after 4.11.0, forgot where I skipped it exactly.","files":null},{"type":3,"author":{"id":"d9b4aee65ce8c18d4a43eced1eecb0d154e1eebb"},"timestamp":1356401287,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDExNjY4MDU5","github-url":"https://github.com/parrot/parrot/issues/887#issuecomment-11668059"},"message":"These persist during `make fulltest` on Linux/i386.\n\n```\ntestr__t/native_pbc/header.t                     (Wstat: 1792 Tests: 9 Failed: 7)\n  Failed tests:  1-7\n  Non-zero exit status: 7\ntestr__t/native_pbc/integer.t                    (Wstat: 512 Tests: 4 Failed: 2)\n  Failed tests:  2-3\n  Non-zero exit status: 2\ntestr__t/native_pbc/number.t                     (Wstat: 768 Tests: 7 Failed: 3)\n  Failed tests:  2-4\n  Non-zero exit status: 3\ntestr__t/native_pbc/string.t                     (Wstat: 512 Tests: 4 Failed: 2)\n  Failed tests:  2-3\n  Non-zero exit status: 2\n```\n\nObserved at commit fb7274d.\n\nAlso, I find that after `make test` and `make fulltest`, I am left with these \"untracked [by git] files\" in my Parrot checkout.\n\n```\n# On branch master\n# Untracked files:\n#   (use \"git add \u003cfile\u003e...\" to include in what will be committed)\n#\n#       t/native_pbc/integer_1.pbc\n#       t/native_pbc/integer_2.pbc\n#       t/native_pbc/integer_3.pbc\n#       t/native_pbc/number_1.pbc\n#       t/native_pbc/number_2.pbc\n#       t/native_pbc/number_3.pbc\n#       t/native_pbc/number_4.pbc\n#       t/native_pbc/string_1.pbc\n#       t/native_pbc/string_2.pbc\n#       t/native_pbc/string_3.pbc\n```","files":null}]}