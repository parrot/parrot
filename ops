{"version":1,"ops":[{"type":1,"author":{"id":"d9b4aee65ce8c18d4a43eced1eecb0d154e1eebb"},"timestamp":1257732680,"metadata":{"github-id":"MDU6SXNzdWUyODQ4ODQ5","github-url":"https://github.com/parrot/parrot/issues/640","origin":"github"},"title":"Parrot::Test with --run-exec assumes \".\" is in $PATH","message":"This ticket moves into the Trac system discussion of an issue previously found in the RT system as [http://rt.perl.org/rt3/Ticket/Display.html?id=49258 RT #49258].  In that ticket, Bob Rogers provided test file ''pbc.t'' which is here attached.\n\nRunning that test file in the original RT, Bob posted this output:\n\n```\nThe attached test case will illustrate the problem (but be sure to\ncheck that $PATH does not contain \".\" first):\n\nrogers@rgrjr\u003e perl pbc.t\n1..1\nnot ok 1 - .const of null string\n# Failed test (pbc.t at line 18)\n# got: ''\n# expected: 'ok\n# '\n# Looks like you failed 1 test of 1.\nrogers@rgrjr\u003e PATH=\".:$PATH\" perl pbc.t\n1..1\nok 1 - .const of null string\nrogers@rgrjr\u003e\n\nI think the right thing would be to mangle $exe_f to start with \n\"./\", but I don't know how to do that portably.\n```\n\nRe-running it today, I got a failure -- but different output:\n\n```\nprove -v pbc.t\npbc.t .. \n1..1\nnot ok 1 - .const of null string\n\n#   Failed test '.const of null string'\n#   at pbc.t line 18.\n#          got: 'error:imcc:syntax error, unexpected DOT, \n           expecting INTV or FLOATV or STRINGV or PMCV ('.')\n#       in file '/topdir/work/parrot/pbc_1.pir' line 3\n# error:imcc:syntax error, unexpected IDENTIFIER, \n           expecting '(' ('empty')\n#       in file '/topdir/work/parrot/pbc_1.pir' line 4\n# error:imcc:syntax error, unexpected STRINGC, \n           expecting '(' ('\"ok\\n\"')\n#       in file '/topdir/work/parrot/pbc_1.pir' line 5\n# '\n#     expected: 'ok\n# '\n# Looks like you failed 1 test of 1.\nDubious, test returned 1 (wstat 256, 0x100)\nFailed 1/1 subtests \n\nTest Summary Report\n-------------------\npbc.t (Wstat: 256 Tests: 1 Failed: 1)\n  Failed test:  1\n  Non-zero exit status: 1\nFiles=1, Tests=1,  0 wallclock secs \n  ( 0.02 usr  0.01 sys +  0.05 cusr  0.00 csys =  0.08 CPU)\nResult: FAIL\n```\n\ngdb had this to say:\n\n```\n(gdb) run pbc_1.pir\nStarting program: /topdir/work/parrot/parrot pbc_1.pir\n[Thread debugging using libthread_db enabled]\nwarning: Lowest section in /usr/lib/libicudata.so.36 is .hash at 000000b4\nerror:imcc:syntax error, unexpected DOT, expecting INTV or \n        FLOATV or STRINGV or PMCV ('.')\n        in file 'pbc_1.pir' line 3\nerror:imcc:syntax error, unexpected IDENTIFIER, expecting '(' ('empty')\n        in file 'pbc_1.pir' line 4\nerror:imcc:syntax error, unexpected STRINGC, expecting '(' ('\"ok\\n\"')\n        in file 'pbc_1.pir' line 5\n\nProgram exited with code 01.\n(gdb) bt\nNo stack.\n```\n\nOriginally http://trac.parrot.org/parrot/ticket/1243","files":null}]}