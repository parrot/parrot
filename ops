{"version":1,"ops":[{"type":3,"author":{"id":"0782f66a529ccd24e18226f5eebab20a90bea166"},"timestamp":1297586235,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDMxNjE=","github-url":"https://github.com/parrot/parrot/issues/448#issuecomment-3503161"},"message":"\u003cp\u003e\nThis is causing partcl-nqp's t/cmd_for.t to fail.\n\u003c/p\u003e","files":null},{"type":3,"author":{"id":"0782f66a529ccd24e18226f5eebab20a90bea166"},"timestamp":1297590742,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDMxNjI=","github-url":"https://github.com/parrot/parrot/issues/448#issuecomment-3503162"},"message":"\u003cp\u003e\nI just ran a bisect on t/cmd_for.t using latest par\n\u003c/p\u003e\n\n\u003cp\u003e\nIt says:\n\u003c/p\u003e\n\n\u003cp\u003e\ncf6e9a458ea5ad9238739acf3fef07cca3d3524a is the first bad commit\ncommit cf6e9a458ea5ad9238739acf3fef07cca3d3524a\nAuthor: Gerd Pokorra \u0026lt;pokorra@…\u0026gt;\nDate:   Tue Oct 19 08:31:46 2010 +0000\n\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\nupdate to 2.9.0\n\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\ngit-svn-id: \u003ca   href=\"https://svn.parrot.org/parrot/trunk@49575\"\u003e\u003cspan class=\"icon\"\u003e \u003c/span\u003ehttps://svn.parrot.org/parrot/trunk@49575\u003c/a\u003e d31e2699-5ff4-0310-a27c-f18f2fbe73fe\n\u003c/p\u003e\n\u003c/blockquote\u003e","files":null},{"type":3,"author":{"id":"0782f66a529ccd24e18226f5eebab20a90bea166"},"timestamp":1297590765,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDMxNjM=","github-url":"https://github.com/parrot/parrot/issues/448#issuecomment-3503163"},"message":"\u003cp\u003e\nwhoops. \"*using latest partcl, and just bisecting on parrot.\n\u003c/p\u003e","files":null},{"type":3,"author":{"id":"0782f66a529ccd24e18226f5eebab20a90bea166"},"timestamp":1299498044,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDMxNjQ=","github-url":"https://github.com/parrot/parrot/issues/448#issuecomment-3503164"},"message":"\u003cp\u003e\nThis is the last remaining blocker for partcl-nqp. (All other tests now pass.)\n\u003c/p\u003e","files":null},{"type":3,"author":{"id":"0782f66a529ccd24e18226f5eebab20a90bea166"},"timestamp":1299499618,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDMxNjU=","github-url":"https://github.com/parrot/parrot/issues/448#issuecomment-3503165"},"message":"\u003cp\u003e\nUnrolling the for loop, here's some tcl code that also demonstrates the issue:\n\u003c/p\u003e\n\n\u003cpre class=\"wiki\"\u003eset i 1\nset i [expr $i+1]\nputs $i\nset i [expr $i+1]\nputs $i\n\u003c/pre\u003e\u003cp\u003e\n(should print 2\\n3\\n)\n\u003c/p\u003e\n\u003cp\u003e\nhowever, THIS code works:\n\u003c/p\u003e\n\u003cpre class=\"wiki\"\u003eset i 1\nset i [expr $i +1]\nputs $i\nset i [expr $i +1]\nputs $i\n\u003c/pre\u003e","files":null},{"type":3,"author":{"id":"aef4977f5ea786238d7c9581a2f192f4adc3f39d"},"timestamp":1300229857,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDMxNjY=","github-url":"https://github.com/parrot/parrot/issues/448#issuecomment-3503166"},"message":"\u003cp\u003e\nHere's the backtrace I get from the failure:\n\u003c/p\u003e\n\n\u003cpre class=\"wiki\"\u003e#0  Parrot_ex_throw_from_c_args (interp=0x79f040, ret_addr_unused=0x0, exitcode=36,\n    format=0x7ffff7b2ffe0 \"%s() not implemented in class '%Ss'\") at src/exceptions.c:440\n#1  0x00007ffff79fd18d in cant_do_method (interp=0x79f040, pmc=0xa54c10, index=168)\n    at /home/andrew/projects/parrot/./src/pmc/default.pmc:148\n#2  0x00007ffff79fd93e in Parrot_default_set_string_native_orig (interp=0x79f040, _self=0xa54c10,\n    value=0x9d1158) at /home/andrew/projects/parrot/./src/pmc/default.c:2602\n#3  0x00007ffff79fa505 in Parrot_default_set_string_native (interp=0x79f040, _self=0xa54c10,\n    value=0x9d1158) at /home/andrew/projects/parrot/./src/pmc/default.c:1862\n#4  0x00007ffff7a25d0a in Parrot_Float_set_string_native_orig (interp=0x79f040, _self=0xa54c10,\n    value=0x9d1158) at /home/andrew/projects/parrot/./src/pmc/float.pmc:181\n#5  0x00007ffff7a224c5 in Parrot_Float_set_string_native (interp=0x79f040, _self=0xa54c10,\n    value=0x9d1158) at /home/andrew/projects/parrot/./src/pmc/float.c:364\n#6  0x00007ffff7acf4eb in Parrot_scalar_concatenate_str (interp=0x79f040, _self=0x914bf8,\n    value=0xd91fb0, dest=0xa54c10) at /home/andrew/projects/parrot/./src/pmc/scalar.pmc:648\n#7  0x00007ffff7934196 in Parrot_concat_p_p_sc (cur_opcode=0xb037a8, interp=0x79f040)\n    at src/ops/core_ops.c:20122\n#8  0x00007ffff79ce688 in runops_fast_core (interp=0x79f040, runcore_unused=0x881300, pc=0xb037a8)\n    at src/runcore/cores.c:513\n#9  0x00007ffff79cdb0b in runops_int (interp=0x79f040, offset=113807) at src/runcore/main.c:218\n#10 0x00007ffff7992325 in runops (interp=0x79f040, offs=113807) at src/call/ops.c:126\n#11 0x00007ffff798a6ad in Parrot_pcc_invoke_from_sig_object (interp=0x79f040, sub_obj=0x9cf288,\n    call_object=0xd8e700) at src/call/pcc.c:323\n#12 0x00007ffff798a4d2 in Parrot_pcc_invoke_sub_from_c_args (interp=0x79f040, sub_obj=0x9cf288,\n    sig=0x7ffff7b343cb \"P-\u0026gt;\") at src/call/pcc.c:130\n#13 0x00007ffff79e6309 in Parrot_pf_execute_bytecode_program (interp=0x79f040, pf=0x89d890,\n    args=0x8905c0) at src/packfile/api.c:4523\n#14 0x00007ffff795d8db in Parrot_api_run_bytecode (interp_pmc=0x873af8, pbc=0x9da358,\n    mainargs=0x8905c0) at src/embed/api.c:457\n#15 0x0000000000400f68 in main ()\n\u003c/pre\u003e\u003cp\u003e\nI need to do some digging, but it appears on quick inspection that this is an MMD-related failure inside scalar.concatinate_str.\n\u003c/p\u003e","files":null},{"type":3,"author":{"id":"aef4977f5ea786238d7c9581a2f192f4adc3f39d"},"timestamp":1300234218,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDMxNjc=","github-url":"https://github.com/parrot/parrot/issues/448#issuecomment-3503167"},"message":"\u003cp\u003e\nOkay, I've figured out what the problem is. I've created the whiteknight/tt_1886 branch to fix it.\n\u003c/p\u003e\n\n\u003cp\u003e\nIn the example, we're calling Parrot_pmc_reuse to convert a Float to a TclString (which is an Object). However, that codepath has undefined behavior. Parrot_pmc_reuse includes a comment suggesting that we should not use it with Objects. Coming back from Parrot_pmc_reuse, the new TclString PMC has a bad vtable structure. When we try to call set_string_native, we go to the wrong vtable and throw the exception.\n\u003c/p\u003e\n\n\u003cp\u003e\nIn the tt_1886 branch I'm going to refactor some of the instantiation logic out of the Class PMC into src/oo.c. Then I'm going to use that logic to implement the proper codepath in Parrot_pmc_reuse to handle the case of morphing to an Object type.\n\u003c/p\u003e","files":null},{"type":3,"author":{"id":"aef4977f5ea786238d7c9581a2f192f4adc3f39d"},"timestamp":1319094375,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDMxNjg=","github-url":"https://github.com/parrot/parrot/issues/448#issuecomment-3503168"},"message":"\u003cp\u003e\nI don't see that branch around anymore, and I didn't keep any records about whether I ever merged it or not.\n\u003c/p\u003e\n\n\u003cp\u003e\nCoke: Can you see if this is still an issue or not?\n\u003c/p\u003e","files":null},{"type":3,"author":{"id":"0782f66a529ccd24e18226f5eebab20a90bea166"},"timestamp":1319100804,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDMxNjk=","github-url":"https://github.com/parrot/parrot/issues/448#issuecomment-3503169"},"message":"\u003cp\u003e\nReplying to \u003ca href=\"http://trac.parrot.org/parrot/ticket/1886#comment:9\" title=\"Comment 9 for Ticket #1886\"\u003ewhiteknight\u003c/a\u003e:\n\u003c/p\u003e\n\n\u003cblockquote class=\"citation\"\u003e\n\u003cp\u003e\n I don't see that branch around anymore, and I didn't keep any records about whether I ever merged it or not.\n Coke: Can you see if this is still an issue or not?\n\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e\nNo change.\n\u003c/p\u003e","files":null},{"type":3,"author":{"id":"2da6485217cbb88ff96be8f3dcc7f9ae44cf6bf0"},"timestamp":1355294132,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDExMjc4NDgx","github-url":"https://github.com/parrot/parrot/issues/455#issuecomment-11278481"},"message":"Any updates on this issue? @Util , do you need any help getting this branch up to date to continue hacking on it?","files":null}]}