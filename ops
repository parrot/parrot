{"version":1,"ops":[{"type":3,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1506864183,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDMzMzM3NjM4MA==","github-url":"https://github.com/parrot/parrot/issues/1238#issuecomment-333376380"},"message":"Which compiler is that? \n**sizeof** is a C89 keyword: http://www.open-std.org/JTC1/SC22/wg14/www/docs/n1124.pdf\n\nthe parens look do superfluous here, but that's our coding standard.\nDoes the patch below fix it?","files":null},{"type":3,"author":{"id":"47f66174084cf85e385bed1f34701da74e495281"},"timestamp":1506947263,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDMzMzUxOTQwOA==","github-url":"https://github.com/parrot/parrot/issues/1238#issuecomment-333519408"},"message":"cc --version\nFreeBSD clang version 4.0.0 (tags/RELEASE_400/final 297347) (based on LLVM 4.0.0)\nTarget: x86_64-unknown-freebsd12.0\nThread model: posix\nInstalledDir: /usr/bin\n\nThe error remains after applying the patch. \n```\nsrc/atomic/gcc_x86.c:54:46: error: function-like macro 'sizeof' is not defined\n#if defined(PARROT_HAS_AMD64_GCC_CMPXCHG) || __WORDSIZE == 64\n                                             ^\n./include/parrot/compiler.h:12:27: note: expanded from macro '__WORDSIZE'\n#  define __WORDSIZE (8 * sizeof(void*))\n                          ^\nsrc/atomic/gcc_x86.c:88:46: error: function-like macro 'sizeof' is not defined\n#if defined(PARROT_HAS_AMD64_GCC_CMPXCHG) || __WORDSIZE == 64\n                                             ^\n./include/parrot/compiler.h:12:27: note: expanded from macro '__WORDSIZE'\n#  define __WORDSIZE (8 * sizeof(void*))\n                          ^\n2 errors generated.\n*** Error code 1\n```\nStop.\nmake: stopped in /usr/home/lzhou/github.com/parrot/parrot/archive/parrot-RELEASE_8_1_0","files":null},{"type":3,"author":{"id":"47f66174084cf85e385bed1f34701da74e495281"},"timestamp":1506948211,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDMzMzUyMjk0MA==","github-url":"https://github.com/parrot/parrot/issues/1238#issuecomment-333522940"},"message":"it seems that sizeof is not recognized by the preprocessor inside #if according to this https://en.wikibooks.org/wiki/C_Programming/Preprocessor","files":null},{"type":3,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1506951523,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDMzMzUzNjg0NQ==","github-url":"https://github.com/parrot/parrot/issues/1238#issuecomment-333536845"},"message":"Interesting. I found that this should fix it:\n```\n#ifndef __WORDSIZE\n#  ifdef __SIZE_WIDTH__\n#    define __WORDSIZE __SIZE_WIDTH__\n#  else\n#    define __WORDSIZE (8 * sizeof void*)\n#  endif\n#endif\n```","files":null},{"type":5,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1506951856,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDEyNzQwNDE3NTE="},"added":["Bug"],"removed":[]},{"type":3,"author":{"id":"901a96a937d41c99363862ec20cf94766cd8c750"},"timestamp":1506952422,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDMzMzU0MTA1OA==","github-url":"https://github.com/parrot/parrot/issues/1238#issuecomment-333541058"},"message":"Sounds surprising. Supposedly `sizeof` requires parentheses for types.","files":null},{"type":3,"author":{"id":"47f66174084cf85e385bed1f34701da74e495281"},"timestamp":1506956143,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDMzMzU1OTUxMg==","github-url":"https://github.com/parrot/parrot/issues/1238#issuecomment-333559512"},"message":"it is fixed. thanks.","files":null},{"type":4,"author":{"id":"47f66174084cf85e385bed1f34701da74e495281"},"timestamp":1506956143,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50MTI3NDE5MzAzMw=="},"status":2},{"type":3,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1506956302,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDMzMzU2MDM2NA==","github-url":"https://github.com/parrot/parrot/issues/1238#issuecomment-333560364"},"message":"I saw several clang bug reports for sizeof. Types should use parens, yes, but apparently their cpp struggles with it. We might want to reconsider this.","files":null}]}