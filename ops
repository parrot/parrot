{"version":1,"ops":[{"type":1,"author":{"id":"6d59fc378929d99368e023bcfc49aacae1e68aad"},"timestamp":1257122985,"metadata":{"github-id":"MDU6SXNzdWUyODQ4NjQ0","github-url":"https://github.com/parrot/parrot/issues/437","origin":"github"},"title":"NCI segfaults with null pcc_params_signature","message":"changes in r32203 cause mod_parrot to segfault, as the param signature is \nan uninitialized string. specifically, the pcc_params_signature NCI \nattribute is null. not sure if this corresponds to a specific parrot \ntest...\n\ncreating the signature as a constant string appears to cause this problem, \nas removing PObj_constant_FLAG from src/pmc/nci.pmc:82 \"fixes\" the issue, \nthough that's most certainly not a solution.\n\nchromatic thinks we need more COW: \"My theory is that the JIT STRING \nconversion needs a Parrot_make_COW_reference.\"\n\ntewk has a workaround: \"short-term comment tools/build/nativecall.pl:308 \nto disable jitted NCI\"\n\nbacktrace is included, now with more stack smashing!\n\n```\nProgram received signal SIGSEGV, Segmentation fault.\n0x40798304 in Parrot_init_arg_sig (interp_unused=0x81b7bf8, ctx=0x832fd78,\nsig=0x0, ap=0x0, sti=0xbffff398) at src/inter_call.c:422\n422 if (*sig) {\n(gdb) bt\n#0 0x40798304 in Parrot_init_arg_sig (interp_unused=0x81b7bf8, \nctx=0x832fd78,\nsig=0x0, ap=0x0, sti=0xbffff398) at src/inter_call.c:422\n#1 0x40797f6c in Parrot_init_arg_nci (interp=0x81b7bf8, st=0xbffff36c,\nsig=0x0) at src/inter_call.c:276\n#2 0x082f6451 in ?? ()\n#3 0x081b7bf8 in ?? ()\n#4 0xbffff36c in ?? ()\n#5 0x00000000 in ?? ()\n#6 0x08193458 in ?? ()\n#7 0x08310418 in ?? ()\n#8 0x00000200 in ?? ()\n#9 0x40cdd2d8 in ?? ()\n#10 0x082dda10 in ?? ()\n#11 0x0832fd78 in ?? ()\n#12 0x00000001 in ?? ()\n#13 0x00000000 in ?? ()\n#14 0x00000000 in ?? ()\n#15 0x00000000 in ?? ()\n#16 0x00000000 in ?? ()\n#17 0x081b7bf8 in ?? ()\n#18 0x08193458 in ?? ()\n#19 0x00000100 in ?? ()\n#20 0x407a0bc3 in key_next (interp=0x81b7bf8, key=0x82e1f4c) at \nsrc/key.c:480\n#21 0x40938a6e in Parrot_NCI_invoke (interp=0x81b7bf8, pmc=0x82e1f4c,\nnext=0x40cdd2ec) at nci.pmc:303\n#22 0x40717116 in Parrot_invokecc_p (cur_opcode=0x40cdd2e4, \ninterp=0x81b7bf8)\nat core.ops:475\n#23 0x407cd83c in runops_slow_core (interp=0x81b7bf8, pc=0x40cdd2e4)\nat src/runops_cores.c:222\n#24 0x4079edb9 in runops_int (interp=0x81b7bf8, offset=80)\nat src/interpreter.c:938\n#25 0x4079f65f in runops (interp=0x81b7bf8, offs=80) at \nsrc/inter_run.c:101\n#26 0x4079f904 in runops_args (interp=0x81b7bf8, sub=0x82dd7fc, \nobj=0x8328fd4,\nmeth_unused=0x826cc5c, sig=0x40ad50e5 \"v\", ap=0xbffff594 \"\\2172\\b\")\nat src/inter_run.c:236\n#27 0x4079fc96 in Parrot_run_meth_fromc_args (interp=0x81b7bf8, \nsub=0x82dd7fc,\nobj=0x8328fd4, meth=0x826cc5c, sig=0x40ad50e5 \"v\") at \nsrc/inter_run.c:426\n#28 0x409a9042 in initialize_parents (interp=0x81b7bf8, object=0x8328fd4,\nall_parents=0x8329108) at class.pmc:344\n#29 0x409aaf7c in Parrot_Class_instantiate (interp=0x81b7bf8, \npmc=0x832923c,\ninit=0x82c8028) at class.pmc:1131\n#30 0x40736446 in Parrot_new_p_pc (cur_opcode=0x40c981b0, \ninterp=0x81b7bf8)\nat pmc.ops:130\n#31 0x407cd83c in runops_slow_core (interp=0x81b7bf8, pc=0x40c981b0)\nat src/runops_cores.c:222\n#32 0x4079edb9 in runops_int (interp=0x81b7bf8, offset=2101)\nat src/interpreter.c:938\n#33 0x4079f65f in runops (interp=0x81b7bf8, offs=2101) at \nsrc/inter_run.c:101\n#34 0x4079f904 in runops_args (interp=0x81b7bf8, sub=0x82e17f8, \nobj=0x82c8028,\nmeth_unused=0x0, sig=0x4043b4d5 \"IP\",\nap=0xbffff7ec \n\"\\2242\\b-\\btz,\\b\u003c-\\bT\\027.\\b\\024C@H\\027ZC@{\\033\\b\\001#\\bIC@x\\2242\\b`\u003c\\bHO\\223\\025@-\\b\\2242\\b0\\2252\\b(\")\nat src/inter_run.c:236\n#35 0x4079fe56 in Parrot_runops_fromc_arglist_reti (interp=0x81b7bf8,\nsub=0x82e17f8, sig=0x4043b4d5 \"IP\",\nargs=0xbffff7ec \n\"\\2242\\b-\\btz,\\b\u003c-\\bT\\027.\\b\\024C@H\\027ZC@{\\033\\b\\001#\\bIC@x\\2242\\b`\u003c\\bHO\\223\\025@-\\b\\2242\\b0\\2252\\b(\")\nat src/inter_run.c:527\n#36 0x4078995c in Parrot_call_sub_ret_int (interp=0x81b7bf8, \nsub=0x82e17f8,\nsignature=0x4043b4d5 \"IP\") at src/extend.c:929\n#37 0x4043834b in modparrot_call_sub_IP (interp=0x81b7bf8,\nnamespace=0x82301d0 \"PIR\", name=0x4043af49 \n\"post_read_request_handler\",\nret=0xbffff878, pmc=0x83294a4) at src/parrot_util.c:167\n#38 0x40435a17 in modparrot_call_meta_handler (interp=0x81b7bf8,\nhll=0x82301d0 \"PIR\", hook=0x4043af49 \"post_read_request_handler\",\nret=0xbffff878) at src/mod_parrot.c:233\n#39 0x40435e91 in modparrot_meta_post_read_request_handler (r=0x83cab60)\nat src/mod_parrot.c:382\n```\n\nOriginally http://trac.parrot.org/parrot/ticket/1173 by jhorwitz","files":null}]}