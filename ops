{"version":1,"ops":[{"type":1,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1355952219,"metadata":{"github-id":"MDU6SXNzdWU5NDE1MzM0","github-url":"https://github.com/parrot/parrot/issues/891","origin":"github"},"title":"win32 replace_slashes","message":"Two issues in this example. \nssh over to cygwin and update your mingw parrot.\n\n```\nrurban@win /usr/src/parrot/win32\n$ cmd /c \"call perl516 \u0026 dmake\"\nperl516 env\nC:\\perl516\\perl\\bin\\perl.exe tools/build/c2str.pl src\\library.c \u003e src\\library.str\n'2str.pl' is not recognized as an internal or external command,\noperable program or batch file.\ndmake:  makefile:  line 129:  Warning: -- Macro `O' redefined after use\ndmake:  makefile:  line 133:  Warning: -- Macro `A' redefined after use\ndmake:  makefile:  line 2060:  Warning: -- Macro `PMC2C_FILES' redefined after use\ndmake:  Warning: -- Found file corresponding to virtual target [include\\parrot\\context.h].\ndmake:  Error code 129, while making 'src\\library.str'\n```\n\nperl516.bat does:\n\n```\n$ cat /cygdrive/c/windows/perl516.bat\n@PATH=C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\System32\\Wbem;C:\\perl516\\c\\bin;\nC:\\perl516\\perl\\site\\bin;C:\\perl516\\perl\\bin;c:\\mingw\\bin\n@echo perl516 env\n```\n- 1. The `tools/build/c2str.pl` part is parsed as `/c` from cmd.exe\n\nUse \\ all over on Windows cmdlines.\nThis is essentially enabling the replace_slashes option to genfile, which is tested, but does not exist.\nOnly in some unused pir library which cannot be used for Configure.pl\n- 1. Replace `-Isrc/` by `-Isrc` and `-I(@D)` by `-I(@D)/.`\n  \n  ...  -Isrc\\string\\ -Isrc\\ -o src\\string\\api.o -c src\\string\\api.c\n  gcc: error: src\\string\\api.o: No such file or directory\n\nWindows gcc fails over `-Isrc\\` and `-Isrc\\string\\` expanded by the make @D macro\n`-Isrc/` can be manually replaced, the @D expansion is best handled by using `-I(@D)/.`\n- 3. Maybe avoid makefile macro redefinitions O,A,PMC2C_FILES. dmake does not like it, as dmake does define it by itself.\n\nThis is a pure dmake issue. dmake defines these by its own. If you have mingw use mingw32-make instead for far better performance.\n- 4. Fix the tests.\n\n`t/configure/034-step.t` tests for the replace_stash option, but passes the test even if the option is not  written yet.\nMost configure step tests are a mess.\nFor example genfile output is captured, but the results (the file contents) are never compared. \nIO::CaptureOutput is not needed, it can be simply replaced by an enhanced Parrot::Configure::Utils::capture_output \nto handle coderefs.\n\nWork is done in the branch `rurban/win-replace_slashes-gh891`","files":null}]}