{"version":1,"ops":[{"type":3,"author":{"id":"c750eb0960e029df836e56dc77bb8c148fcf5723"},"timestamp":1274533610,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDMzMDI=","github-url":"https://github.com/parrot/parrot/issues/473#issuecomment-3503302"},"message":"\u003cp\u003e\nThere are (at least) 2 things going wrong here:\n\u003c/p\u003e\n\n\u003cul\u003e\u003cli\u003eline numbers are not being updated properly\n\u003c/li\u003e\u003cli\u003ethe frame stack is getting confused somewhere\n\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e\nThe line number updating is wonky in general because it expects to update on \"\u003csup\u003e{WS}_\" (and a couple other places as a kludge). Lex attempts to match the *longest_ token at the current location. When there is non-whitespace at the beginning of the line, the beginning of line rule will be zero-width and won't get executed. The correct handling of this would be to update the line numbers at EOL, which is guarranteed non-zero width. A workaround for the time being is to indent all code (except heredocs).\n\u003c/sup\u003e\u003c/p\u003e\n\n\u003cp\u003e\nWhen I indent sections near the include points, I get:\n\u003c/p\u003e\n\n\u003cpre class=\"wiki\"\u003e\nerror:imcc:syntax error, unexpected DOT, expecting $end ('.')\n    in file 'src/builtins/EnumMap.pir' line 30\n    included from 'src/gen/builtins.pir' line 98\n    included from 'src/Perl6/Compiler.pir' line 1\n\u003c/pre\u003e\u003cp\u003e\nThe line numbers are correct, but associated with the wrong files. I am still investigating this frame stack corruption.\n\u003c/p\u003e","files":null},{"type":3,"author":{"id":"c750eb0960e029df836e56dc77bb8c148fcf5723"},"timestamp":1274611738,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDMzMDM=","github-url":"https://github.com/parrot/parrot/issues/473#issuecomment-3503303"},"message":"\u003cp\u003e\nfixed in r46906.\n\u003c/p\u003e","files":null},{"type":3,"author":{"id":"c750eb0960e029df836e56dc77bb8c148fcf5723"},"timestamp":1274611822,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDMzMDQ=","github-url":"https://github.com/parrot/parrot/issues/473#issuecomment-3503304"},"message":"\u003cp\u003e\nclosed wrong ticket. plobsing-- plobsing--\n\u003c/p\u003e","files":null},{"type":3,"author":{"id":"d9b4aee65ce8c18d4a43eced1eecb0d154e1eebb"},"timestamp":1309944535,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDMzMDU=","github-url":"https://github.com/parrot/parrot/issues/473#issuecomment-3503305"},"message":"\u003cp\u003e\nI note from widespread cursing on #parrot that line numbers in IMCC are still borked.\n\u003c/p\u003e\n\n\u003cp\u003e\nDo we have any more insight into the particular issues raised in this ticket?\n\u003c/p\u003e\n\n\u003cp\u003e\nThank you very much.\n\u003c/p\u003e\n\n\u003cp\u003e\nkid51\n\u003c/p\u003e","files":null}]}