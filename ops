{"version":1,"ops":[{"type":1,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1393549787,"metadata":{"github-id":"MDU6SXNzdWUyODQ3MDY1Nw==","github-url":"https://github.com/parrot/parrot/issues/1043","origin":"github"},"title":"-O2 check types in constant propagation","message":"```\n$ cat t/op/jitn_13.pir\n.sub _main :main\n    .local num n\n    .local int i\n    n = 1.4\n    i = n\n    print i\n    n = 2.5\n    i = n\n    print i\n    n = 3.6\n    i = n\n    print i\n\n    print \"\\n\"\n    end\n.end\n```\n\n`./parrot -d7161 -O2 t/op/jitn_13.pir`\n=\u003e\n\n```\ndebug = 0x7161, optim = 0x3\nReading t/op/jitn_13.pir\npropagating constant 0x2ac15560 set n, 1.4\n    checking op 0x2ac155d0 set i, n\n checking register 1 0x2ac155d0 set i, n\n    propagating into register 1: 0x2ac155d0 set i, n\n -\u003e 0x2ac155d0 set i, 1.4\n    checking op 0x2ac15660 print i\n    checking op 0x2ac15770 set n, 2.5\n checking register 0 0x2ac15770 set n, 2.5\npropagating constant 0x2ac155d0 set i, 1.4\n    checking op 0x2ac15660 print i\n checking register 0 0x2ac15660 print i\n    propagating into register 0: 0x2ac15660 print i\n -\u003e 0x2ac15660 print 1.4\n    checking op 0x2ac15770 set n, 2.5\n    checking op 0x2ac157e0 set i, n\n checking register 0 0x2ac157e0 set i, n\npropagating constant 0x2ac15770 set n, 2.5\n    checking op 0x2ac157e0 set i, n\n checking register 1 0x2ac157e0 set i, n\n    propagating into register 1: 0x2ac157e0 set i, n\n -\u003e 0x2ac157e0 set i, 2.5\n    checking op 0x2ac15870 print i\n    checking op 0x2ac15980 set n, 3.6\n checking register 0 0x2ac15980 set n, 3.6\npropagating constant 0x2ac157e0 set i, 2.5\n    checking op 0x2ac15870 print i\n checking register 0 0x2ac15870 print i\n    propagating into register 0: 0x2ac15870 print i\n -\u003e 0x2ac15870 print 2.5\n    checking op 0x2ac15980 set n, 3.6\n    checking op 0x2ac159f0 set i, n\n checking register 0 0x2ac159f0 set i, n\npropagating constant 0x2ac15980 set n, 3.6\n    checking op 0x2ac159f0 set i, n\n checking register 1 0x2ac159f0 set i, n\n    propagating into register 1: 0x2ac159f0 set i, n\n -\u003e 0x2ac159f0 set i, 3.6\n    checking op 0x2ac15a80 print i\n    checking op 0x2ac15ba0 print \"\\n\"\n    checking op 0x2ac15c10 end\npropagating constant 0x2ac159f0 set i, 3.6\n    checking op 0x2ac15a80 print i\n checking register 0 0x2ac15a80 print i\n    propagating into register 0: 0x2ac15a80 print i\n -\u003e 0x2ac15a80 print 3.6\n    checking op 0x2ac15ba0 print \"\\n\"\n    checking op 0x2ac15c10 end\npropagating constant 0x2ac15560 set n, 1.4\n    checking op 0x2ac155d0 set i, 1.4\n    checking op 0x2ac15660 print 1.4\n    checking op 0x2ac15770 set n, 2.5\n checking register 0 0x2ac15770 set n, 2.5\npropagating constant 0x2ac155d0 set i, 1.4\n    checking op 0x2ac15660 print 1.4\n    checking op 0x2ac15770 set n, 2.5\n    checking op 0x2ac157e0 set i, 2.5\n checking register 0 0x2ac157e0 set i, 2.5\npropagating constant 0x2ac15770 set n, 2.5\n    checking op 0x2ac157e0 set i, 2.5\n    checking op 0x2ac15870 print 2.5\n    checking op 0x2ac15980 set n, 3.6\n checking register 0 0x2ac15980 set n, 3.6\npropagating constant 0x2ac157e0 set i, 2.5\n    checking op 0x2ac15870 print 2.5\n    checking op 0x2ac15980 set n, 3.6\n    checking op 0x2ac159f0 set i, 3.6\n checking register 0 0x2ac159f0 set i, 3.6\npropagating constant 0x2ac15980 set n, 3.6\n    checking op 0x2ac159f0 set i, 3.6\n    checking op 0x2ac15a80 print 3.6\n    checking op 0x2ac15ba0 print \"\\n\"\n    checking op 0x2ac15c10 end\npropagating constant 0x2ac159f0 set i, 3.6\n    checking op 0x2ac15a80 print 3.6\n    checking op 0x2ac15ba0 print \"\\n\"\n    checking op 0x2ac15c10 end\nsub _main:\n    registers in .pir:   I1, N1, S0, P0\n    0 labels, 0 lines deleted, 0 if_branch, 0 branch_branch\n    0 branch_cond_loop\n    0 used once deleted\n    0 invariants_moved\n    registers needed:    I1, N1, S0, P0\n    registers in .pasm:  I1, N1, S0, P0 - 0\n    1 basic_blocks, 0 edges\ncode_size(ops) 27  old_size 0\nconst 1.4   color 0 use_count 1\nconst 2.5   color 1 use_count 1\nconst 3.6   color 2 use_count 1\nconst \"\\n\"  color 0 use_count 1\nadd_const_pmc_sub '_main' flags 10 color 0 (Sub) lex_info no :outer(*none*)\n0 set_n_nc 0 0  0x2ac15560 set N0, 1.4\n3 set_i_nc 0 0  0x2ac155d0 set I0, 1.4\n6 print_nc 0    0x2ac15660 print 1.4\n8 set_n_nc 0 1  0x2ac15770 set N0, 2.5\n11 set_i_nc 0 1 0x2ac157e0 set I0, 2.5\n14 print_nc 1   0x2ac15870 print 2.5\n16 set_n_nc 0 2 0x2ac15980 set N0, 3.6\n19 set_i_nc 0 2 0x2ac159f0 set I0, 3.6\n22 print_nc 2   0x2ac15a80 print 3.6\n24 print_sc 0   0x2ac15ba0 print \"\\n\"\n26 end  0x2ac15c10 end\n1 lines compiled.\n1.42.53.6\n```","files":null}]}