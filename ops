{"version":1,"ops":[{"type":3,"author":{"id":"099af60226e2576bd4ff0f5c2614b710c745cab6"},"timestamp":1294172527,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDM0Mzk=","github-url":"https://github.com/parrot/parrot/issues/516#issuecomment-3503439"},"message":"\u003cp\u003e\nHello.\n\u003c/p\u003e\n\n\u003cp\u003e\nMy bisect showing commits related to \u003ca class=\"new ticket\" href=\"http://trac.parrot.org/parrot/ticket/1704\" title=\"deprecation: Implicit selection of main sub is deprecated. (new)\"\u003e#1704\u003c/a\u003e. Unfortunatelly branch (?) was merged without \"--no-ff\" param and can't be easily reverted.\n\u003c/p\u003e\n\n\u003cp\u003e\n--\nBacek\n\u003c/p\u003e","files":null},{"type":3,"author":{"id":"0c9c62332064205b2d799407019fa3e7e2f43862"},"timestamp":1294194838,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDM0NDA=","github-url":"https://github.com/parrot/parrot/issues/516#issuecomment-3503440"},"message":"\u003cpre class=\"wiki\"\u003eOn Tue, Jan 04, 2011 at 11:14:43AM -0000, Parrot wrote:\n\u0026gt; #1932: rakudo on parrot RELEASE_2_11_0-656-g27c0799 executes main body twice\n\u0026gt;  {{{\n\u0026gt;  $ ./perl6 -e 'say 3'\n\u0026gt;  3\n\u0026gt;  3\n\u0026gt;  }}}\n\u0026gt;\n\u0026gt;  likewise all test files confuse the test harness.\n\u0026gt;\n\u0026gt;  This didn't happen on RELEASE_2_11_0-478-gd69dbbc for example, and in the\n\u0026gt;  mean time rakudo didn't change signficantly.\nNQP-rx exhibits a similar (same?) problem with RELEASE_2_11_0-663-g7cc276c --\nmany tests end up running twice and confusing the test harness.\nIt appears to be the same set of tests that were suffering from the\nimplicit :main issues discussed in TT #1704, so I suggest that's a likely\nstarting point for tracking down this problem.\nPm\n\u003c/pre\u003e","files":null},{"type":3,"author":{"id":"0c9c62332064205b2d799407019fa3e7e2f43862"},"timestamp":1294229575,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDM0NDE=","github-url":"https://github.com/parrot/parrot/issues/516#issuecomment-3503441"},"message":"\u003cp\u003e\nPart of the problem may be that :load subs are being executed even when being loaded outside of the load_bytecode opcode (which goes against PDD 19).\n\u003c/p\u003e\n\n\u003cpre class=\"wiki\"\u003e$ cat x.pir\n.sub 'first'\n    say 'first'\n.end\n.sub 'load' :load\n    say ':load'\n.end\n$ ./parrot x.pir\n:load\nfirst\n$\n\u003c/pre\u003e\u003cp\u003e\nHere we can see that the :load sub is being invoked even when not loaded via load_bytecode.\n\u003c/p\u003e\n\n\u003cp\u003e\nNQP and Rakudo have to generate :load subs at the end of each module to automatically invoke the module's mainline when the module is loaded via load_bytecode.  Since :load subs are now being invoked even for the initial program file or when compiled in memory (which is the province of the :init flag), the mainline gets executed \"twice\".\n\u003c/p\u003e\n\n\u003cp\u003e\nPm\n\u003c/p\u003e","files":null},{"type":3,"author":{"id":"c750eb0960e029df836e56dc77bb8c148fcf5723"},"timestamp":1294233587,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDM0NDI=","github-url":"https://github.com/parrot/parrot/issues/516#issuecomment-3503442"},"message":"\u003cp\u003e\nReplying to \u003ca href=\"http://trac.parrot.org/parrot/ticket/1932#comment:3\" title=\"Comment 3 for Ticket #1932\"\u003epmichaud\u003c/a\u003e:\nshould be remedied at 9dda543\n\u003c/p\u003e","files":null},{"type":3,"author":{"id":"d9b4aee65ce8c18d4a43eced1eecb0d154e1eebb"},"timestamp":1294278822,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDM0NDM=","github-url":"https://github.com/parrot/parrot/issues/516#issuecomment-3503443"},"message":"\u003cp\u003e\nAs of commit b9e9c3cb8ad4c84853edaa3114bda8456f0783cc, I believe this problem is fixed.\n\u003c/p\u003e\n\n\u003cp\u003e\n1.\n\u003c/p\u003e\n\n\u003cpre class=\"wiki\"\u003e[parrot@W5028539] 516 $ cat ../rakudo/parrot/x.pir\n.sub 'first'\n    say 'first'\n.end\n.sub 'load' :load\n    say ':load'\n.end\n[parrot@W5028539] 517 $ ./parrot ../rakudo/parrot/x.pir\nfirst\n\u003c/pre\u003e\u003cp\u003e\n2.\n\u003c/p\u003e\n\u003cpre class=\"wiki\"\u003e[rakudo@W5028539] 520 $ ./perl6 -e 'say 3'\n3\n\u003c/pre\u003e\u003cp\u003e\n3. I have both NQP-RX and Rakudo passing their respective \u003ctt\u003emake test\u003c/tt\u003e suites.\n\u003c/p\u003e\n\n\u003cp\u003e\nmoritz/pmichaud:  Can you verify and close the ticket?  Thank you very much.\n\u003c/p\u003e\n\n\u003cp\u003e\nkid51\n\u003c/p\u003e","files":null},{"type":3,"author":{"id":"76484e451c8adcf68d1a41e60ab7fdf43d921282"},"timestamp":1294453423,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDM0NDQ=","github-url":"https://github.com/parrot/parrot/issues/516#issuecomment-3503444"},"message":"\u003cp\u003e\nThis problem is indeed fixed, so the ticket can be closed as soon as there is test coverage in the parrot test suite.\n\u003c/p\u003e","files":null}]}