{"version":1,"ops":[{"type":3,"author":{"id":"507abfae537e007c08969e763a32a0acbd878b1b"},"timestamp":1331024314,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDQzNDA4NzA=","github-url":"https://github.com/parrot/parrot/issues/730#issuecomment-4340870"},"message":"On Tuesday 06 March 2012 00:53:45 you wrote:\n\n\u003e It appears that the test labeled 'nci_cb_D4 - synchronous callbacks' in\n\u003e t/pmc/nci.t in Parrot 3.10.0 is dependent on the speed of the CPU the test\n\u003e is performed on.  On my lowly 1GHz P3 system, this test failed, because the\n\u003e conversion to a synchronous callback happened too early to get the expected\n\u003e result.  Doubling the time fixed it for me, but we're not in a hurry, so I\n\u003e suggest this change instead, multiplying the time with 20x:\n\u003e \n\u003e I have not yet checked to see if the same issue exists in newer versions of\n\u003e Parrot.\n\nThis has already been fixed on Nov 27th in commit:\n29adeaba744976d82d80596f6c677c3c77db45c7\n\nRegards,\nStefan","files":null},{"type":3,"author":{"id":"aef4977f5ea786238d7c9581a2f192f4adc3f39d"},"timestamp":1331040106,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDQzNDQxMjY=","github-url":"https://github.com/parrot/parrot/issues/730#issuecomment-4344126"},"message":"It strikes me that this is a lousy test to begin with. Instead of using a timer, we should have some kind of event handler get triggered when the callback is ready, and loop until the callback is ready to be tested. Using a simple sleep timer is always going to create false negatives in test results on slow or heavily loaded machines.","files":null},{"type":3,"author":{"id":"507abfae537e007c08969e763a32a0acbd878b1b"},"timestamp":1331040699,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDQzNDQyNzU=","github-url":"https://github.com/parrot/parrot/issues/730#issuecomment-4344275"},"message":"Have a look at the current version, it's already pretty much like you describe. It's not using sleep anymore. I guess sleep was ever only used because pass was not available at the time.\n\nThe only thing bothering me about the current implementation is that it's looping until the correct result is available. So if the callback finishes but somehow just does not produce the correct result, the test will hang forever. But it should at least no longer depend on any timing effects.","files":null},{"type":3,"author":{"id":"5c5a1437d57bc93e00fe40289d8c8a34b3bf11f0"},"timestamp":1331041743,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDQzNDQ1MTQ=","github-url":"https://github.com/parrot/parrot/issues/730#issuecomment-4344514"},"message":"Sounds good, I'll close this issue.\n(I'm packaging parrot for pkgsrc, and want to have all versions committed, and have been\nstrapped for time lately, and I also wanted the tests to pass...  That's the reason I'm looking\nat 3.10.0 and not something newer.  I'll get there, eventually.)","files":null},{"type":4,"author":{"id":"5c5a1437d57bc93e00fe40289d8c8a34b3bf11f0"},"timestamp":1331041744,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50MTA4MTk2NTY="},"status":2}]}