{"version":1,"ops":[{"type":1,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1335994973,"metadata":{"github-id":"MDU6SXNzdWU0Mzk0MjA1","github-url":"https://github.com/parrot/parrot/issues/761","origin":"github"},"title":"cygwin needs to strictly decide between X11 opengl and non-X11 opengl","message":"My previous opengl patch - skip /usr/include/ on X11 if DISPLAY is not set - is not stable enough, if DISPLAY is set.\nIt would include X11 and non-X11 headers, which differ. (w32api GLUT vs freeglut X11)\n\nThis is a more stable logic:\n\n```\n--- origsrc/parrot-4.3.0/config/gen/opengl.pm   2011-09-21 09:51:30.000000000 -0500\n+++ src/parrot-4.3.0/config/gen/opengl.pm       2012-05-02 16:14:35.720361000 -0500\n@@ -447,7 +447,7 @@ sub runstep {\n         '/System/Library/Frameworks/GLUT.framework/Headers/*.h',\n\n         # Cygwin\n-        '/usr/include/w32api/GL/*.h',\n+        # '/usr/include/w32api/GL/*.h',\n\n         # Windows/MSVC\n         (map \"$_/gl/*.h\" =\u003e @include_paths_win32),\n@@ -487,7 +487,12 @@ sub runstep {\n     );\n\n     # X freeglut only if DISPLAY is set, otherwise use native w32api GLUT\n-    shift @header_globs if $^O eq 'cygwin' and !$ENV{DISPLAY};\n+    if ($^O eq 'cygwin') {\n+        if (!$ENV{DISPLAY}) {\n+            shift @header_globs; # no X\n+            unshift @header_globs, '/usr/include/w32api/GL/*.h';\n+        }\n+    }\n\n     my $globs_str = join(\"\\n\\t\", @header_globs) . \"\\n\";\n     $conf-\u003edebug(\n```","files":null}]}