{"version":1,"ops":[{"type":1,"author":{"id":"5c5a1437d57bc93e00fe40289d8c8a34b3bf11f0"},"timestamp":1321452643,"metadata":{"github-id":"MDU6SXNzdWUyMjU2NTQz","github-url":"https://github.com/parrot/parrot/issues/201","origin":"github"},"title":"Work-directory references in installed files","message":"While packaging up Parrot 3.8.0 for NetBSD's pkgsrc package system, it is apparent that\nrelatively recently pkgsrc has become stricter about not allowing work-directory references\nin installed files.\n\nParrot 3.8.0 tries to install no less than 12 files with work-directory references.\n\nCarrying around references to the build / work directory can be dangerous, as there is no\nguarantee that it will or will not exist at any point in the future, and if that directory is included\nin any form of search list, at best unpredictable behavior can ensue.\n\nThe files with work-directory references and the corresponding \"strings -a | grep work\" entries are:\n\nbin/ops2c\n\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n-L\"/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\" -lparrot\n\"-Wl,-R/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\"\n/usr/pkgsrc/lang/parrot/work/.tools/bin/tar\n\n(library references, no less!)\n\nbin/parrot\n\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n-L\"/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\" -lparrot\n\"-Wl,-R/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\"\n/usr/pkgsrc/lang/parrot/work/.tools/bin/tar\n\nbin/parrot-nqp\n\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n-L\"/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\" -lparrot\n\"-Wl,-R/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\"\n/usr/pkgsrc/lang/parrot/work/.tools/bin/tar\n\nbin/parrot-prove\n\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n-L\"/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\" -lparrot\n\"-Wl,-R/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\"\n/usr/pkgsrc/lang/parrot/work/.tools/bin/tar\n\nbin/parrot_config\n\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n-L\"/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\" -lparrot\n\"-Wl,-R/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\"\n/usr/pkgsrc/lang/parrot/work/.tools/bin/tar\n\nbin/parrot_nci_thunk_gen\n\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n-L\"/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\" -lparrot\n\"-Wl,-R/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\"\n/usr/pkgsrc/lang/parrot/work/.tools/bin/tar\n\nbin/pbc_merge\n\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n-L\"/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\" -lparrot\n\"-Wl,-R/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\"\n/usr/pkgsrc/lang/parrot/work/.tools/bin/tar\n\nbin/pbc_to_exe\n\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n-L\"/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\" -lparrot\n\"-Wl,-R/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\"\n/usr/pkgsrc/lang/parrot/work/.tools/bin/tar\n\nbin/winxed\n\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n-L\"/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\" -lparrot\n\"-Wl,-R/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\"\n/usr/pkgsrc/lang/parrot/work/.tools/bin/tar\n\nlib/parrot/3.8.0/include/config.fpmc\n\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n-L\"/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\" -lparrot\n\"-Wl,-R/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\"\n/usr/pkgsrc/lang/parrot/work/.tools/bin/tar\n\nlib/parrot/3.8.0/parrot_config.o\n\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n/usr/pkgsrc/lang/parrot/work/parrot-3.8.0\n-L\"/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\" -lparrot\n\"-Wl,-R/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\"\n/usr/pkgsrc/lang/parrot/work/.tools/bin/tar\n\nlib/parrot/3.8.0/tools/lib/Parrot/Config/Generated.pm\n\n  'build_dir' =\u003e '/usr/pkgsrc/lang/parrot/work/parrot-3.8.0',\n  'coveragedir' =\u003e '/usr/pkgsrc/lang/parrot/work/parrot-3.8.0',\n  'libparrot_linkflags' =\u003e '-L\"/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\" -lparrot',\n  'rpath_blib' =\u003e '\"-Wl,-R/usr/pkgsrc/lang/parrot/work/parrot-3.8.0/blib/lib\"',\n  'tar' =\u003e '/usr/pkgsrc/lang/parrot/work/.tools/bin/tar',\n\nNow, many if not most of these come from this last generated configuration file, it would appear.\nI'm uncertain of the strategy to deal with these issues -- maybe these settings should be\nfarmed out to a separate file which is only used during the build phase, and which is not\nconverted into an object file and embedded in the installed binaries?","files":null}]}