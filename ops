{"version":1,"ops":[{"type":1,"author":{"id":"8c86ede03c8e80b0dad5131138f96e957a4ee66b"},"timestamp":1381128288,"metadata":{"github-id":"MDU6SXNzdWUyMDU5NDk1MA==","github-url":"https://github.com/parrot/parrot/issues/1009","origin":"github"},"title":"Method lookup meta-error on classes","message":"Reported by: zefram@fysh.org\n\nWhen a named method is called on an object, but the invocant class doesn't define a method of that name, an error message is generated. Normally the error message refers to the class of the invocant, but if the invocant is a class object then the error message gets it wrong: it shows the name of the class represented by the invocant object instead of the class of the invocant. If the invocant is an _anonymous_ class then a completely different error message is generated.\n\nIn these examples (correct behaviour and then the two incorrect cases), I use typeof on the invocant to show what class name should appear in the error message that comes from the method call.\n\n```\n$ cat t48.pir \n.sub main :main\n       $P0 = newclass \"Foo\"\n       $P1 = new $P0\n       $S0 = typeof $P1\n       say $S0\n       $P2 = $P1.\"wibble\"()\n.end\n```\n\n```\n$ ./parrot t48.pir \nFoo\nMethod 'wibble' not found for invocant of class 'Foo'\ncurrent instr.: 'main' pc 17 (t48.pir:6)\n```\n\n```\n$ cat t47.pir \n.sub main :main\n       $P0 = newclass \"Foo\"\n       $P1 = subclass $P0, \"Bar\"\n       $S0 = typeof $P1\n       say $S0\n       $P2 = $P1.\"wibble\"()\n.end\n```\n\n```\n$ ./parrot t47.pir \nClass\nMethod 'wibble' not found for invocant of class 'Bar'\ncurrent instr.: 'main' pc 18 (t47.pir:6)\n```\n\n```\n$ cat t45.pir \n.sub main :main\n       $P0 = newclass \"Foo\"\n       $P1 = subclass $P0\n       $S0 = typeof $P1\n       say $S0\n       $P2 = $P1.\"wibble\"()\n.end\n```\n\n```\n$ ./parrot t45.pir \nClass\nAttempt to create PMC Proxy for invalid type number = 0!\ncurrent instr.: 'main' pc 17 (t45.pir:6)\n```\n\n-zefram\n\n```\nSummary of my parrot 5.7.0 configuration:\n configdate='Sat Oct  5 12:42:43 2013 GMT'\n Platform:\n   osname=linux, archname=x86_64-linux-gnu-thread-multi\n   perl=/usr/bin/perl\n```","files":null}]}