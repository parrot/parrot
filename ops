{"version":1,"ops":[{"type":3,"author":{"id":"6d59fc378929d99368e023bcfc49aacae1e68aad"},"timestamp":1245369865,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDI2MjA=","github-url":"https://github.com/parrot/parrot/issues/286#issuecomment-3502620"},"message":"125313 byte attachment from MoC\nat http://trac.parrot.org/parrot/raw-attachment/ticket/775/Makefile\nis too big for GitHub.","files":null},{"type":3,"author":{"id":"6d59fc378929d99368e023bcfc49aacae1e68aad"},"timestamp":1245387865,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDI2MjE=","github-url":"https://github.com/parrot/parrot/issues/286#issuecomment-3502621"},"message":"Trac commenter: MoC\n\n```\n    \u003cp\u003e\n```\n\nMakefile\n\u003c/p\u003e","files":null},{"type":3,"author":{"id":"6d59fc378929d99368e023bcfc49aacae1e68aad"},"timestamp":1245388354,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDI2MjI=","github-url":"https://github.com/parrot/parrot/issues/286#issuecomment-3502622"},"message":"Trac commenter: MoC\n\n\u003cp\u003e\nI have to correct myself, Strawberry Perl actually also includes mingw32-make with which it works fine.\nPlus: Even though it might look like it judging from the Makefile I was trying to build in cmd.exe environment, not MSYS environment.\n\u003c/p\u003e","files":null},{"type":3,"author":{"id":"6d59fc378929d99368e023bcfc49aacae1e68aad"},"timestamp":1245389210,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDI2MjM=","github-url":"https://github.com/parrot/parrot/issues/286#issuecomment-3502623"},"message":"\u003cp\u003e\nI do some testing with Strawberry Perl. It does not recommend dmake for me, I suppose that must depend on the order of directories in PATH.\n\u003c/p\u003e\n\n\u003cp\u003e\nThe main problem is caused by the usage of [ ] at the beginning of a command. Looks like this confuses dmake, don't know why. Replacing it whit 'test' fixes the problem.\n\u003c/p\u003e\n\n\u003cp\u003e\nAfter fixing that, it fails on 'if' commands. Looks like is trying to execute 'if' as a program instead of letting a shell take care of it. As a quick test I replaced all 'if' with 'cmd /c if', after doing that it has the same problem with 'rem' (value assigned to RANLIB).\n\u003c/p\u003e\n\n\u003cp\u003e\nAt this point, I'm blocked. Don't know if replacing 'if' with something like $(SHELL) /c will not break other win32 builds, and don't know where the 'rem' value for RANLIB comes from.\n\u003c/p\u003e","files":null},{"type":3,"author":{"id":"6d59fc378929d99368e023bcfc49aacae1e68aad"},"timestamp":1245451476,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDI2MjQ=","github-url":"https://github.com/parrot/parrot/issues/286#issuecomment-3502624"},"message":"\u003cp\u003e\nReplying to \u003ca href=\"http://trac.parrot.org/parrot/ticket/775#comment:2\" title=\"Comment 2 for Ticket #775\"\u003eNotFound\u003c/a\u003e:\n\u003c/p\u003e\n\n\u003cblockquote class=\"citation\"\u003e\n\u003cp\u003e\n I do some testing with Strawberry Perl. It does not recommend dmake for me, I suppose that must depend on the order of\n directories in PATH.\n The main problem is caused by the usage of [ ] at the beginning of a command. Looks like this confuses dmake, don't know why.\n Replacing it whit 'test' fixes the problem.\n\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e\ndmake uses \u003ctt\u003e[\u003c/tt\u003e and \u003ctt\u003e]\u003c/tt\u003e for its own special grouping purposes.  Replacing\nthem with 'test' allows dmake to successfully parse the line, but it still\nwon't actually work.  However, since it's in the 'release:' target,\ndmake won't ever try to execute it anyway, unless someone is trying to\nbuild a release.\n\u003c/p\u003e\n\n\u003cblockquote class=\"citation\"\u003e\n\u003cp\u003e\n After fixing that, it fails on 'if' commands. Looks like is trying to execute 'if' as a program instead of letting a shell\n take care of it. As a quick test I replaced all 'if' with 'cmd /c if', after doing that it has the same problem with 'rem'\n (value assigned to RANLIB).\n At this point, I'm blocked. Don't know if replacing 'if' with something like $(SHELL) /c will not break other win32 builds,\n and don't know where the 'rem' value for RANLIB comes from.\n\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e\nThe 'rem' value comes from perl5's Configure.  It's just a 'remark'\nor comment in DOS batch files.  The Win32 library build process does\nnot need to use 'ranlib' so it just ends up commented out.\n\u003c/p\u003e\n\n\u003cp\u003e\nFor parrot, it would probably be better to simply omit the line\n\u003c/p\u003e\n\n\u003cpre class=\"wiki\"\u003e  $(RANLIB) $@\n\u003c/pre\u003e\u003cp\u003e\nfrom the Makefile if it's not going to be used anyway.  Alternatively, it\nmay be that merely defining SHELL in the Makefile is sufficient for dmake.\nI don't know; I don't have any easy way to test.\n\u003c/p\u003e\n\n\u003cp\u003e\nAs for the 'if exists' lines, it's hard to know what to make of them.\nI have no idea what '.manifest' files are or how they get created.\nI found no useful information of any sort in the parrot tree.  Are they\ncreated during the build process by some tool, or are they added \"by hand\"\nand used if they happen to be there?  Perhaps someone who understands\nthe process better can suggest an appropriate approach.\n\u003c/p\u003e\n\n\u003cp\u003e\nStepping back a moment, though, look at the relevant line in\nconfig/gen/makefiles/root.in:\n\u003c/p\u003e\n\n\u003cpre class=\"wiki\"\u003e#IF(win32):   if exist $@.manifest mt.exe -nologo -manifest $@.manifest -outputresource:$@;1\n\u003c/pre\u003e\u003cp\u003e\nThis is using perl to determine if the user is on Win32, passing that\nto a special home-brewed pre-processor to decide whether to include\na specific line in Makefile, and then passing that result on to DOS\nto perform a conditional operation to decide whether to run mt.exe.\nThat's mad.  There are three conditional tests being performed by three\ndifferent tools for just one line in the Makefile.  This is then repeated\n31 more times in the parrot tree.\n\u003c/p\u003e\n\n\u003cp\u003e\nWhy not simply have perl do the 'if exist' test in Configure.pl\n(or whatever the appropriate logic would be) and store the result in\n$PConfig{win32_use_manifests}?  Something like this:\n\u003c/p\u003e\n\n\u003cpre class=\"wiki\"\u003e#IF(win32_use_manifests): mt.exe -nologo -manifest $@.manifest -outputresource:$@;1\n\u003c/pre\u003e\u003cp\u003e\nThis way the 32 copies of this logic could be collapsed in one\n_documented_ Configure.pl variable.\n\u003c/p\u003e","files":null},{"type":3,"author":{"id":"0782f66a529ccd24e18226f5eebab20a90bea166"},"timestamp":1276426731,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM1MDI2MjU=","github-url":"https://github.com/parrot/parrot/issues/286#issuecomment-3502625"},"message":"\u003cp\u003e\nChanging summary to reflect Andy's suggestion a year ago.\n\u003c/p\u003e","files":null},{"type":3,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1395433440,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM4MzE5OTQ2","github-url":"https://github.com/parrot/parrot/issues/286#issuecomment-38319946"},"message":"ranlib is needed for older systems, like my powerbook G5/ppc.\narchives need to be sorted. it is commented out for windows.\n\nyour `#IF(win32):` analysis is completely off:\nthe value of the config hash is queried for win32 at config-time, \nand at make-time the shell creates the manifest if it does not \nalready exist. Nothing wrong with that.\n\nmanifests are mandatory for newer windows versions.\n\ndmake works but is horribly slow. mingw32-make is always preferred and is the default already.\n\nThe rest was improved with 4.11.0:\n          More compilation fixes on Windows without working mt.exe or ranlib=rem,\n\nThe only remaining mingw problems are inproper / slash issues in compiler/imcc paths, \nbut this has nothing to do with this ticket. See #1063 instead.","files":null},{"type":4,"author":{"id":"86141a663c2eb7543d1a51ec6253a1d54de912fd"},"timestamp":1395433440,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50MTA0Mzc5MjYx"},"status":2}]}