/*
Copyright: 2001-2003 The Perl Foundation.  All Rights Reserved.
$Id$

=head1 NAME

classes/csub.pmc - C Subroutine PMC

=head1 DESCRIPTION

This class has been superceeded by C<NCI>.

=cut

*/

#include "parrot/parrot.h"
#include "parrot/method_util.h"

pmclass CSub {
    void init () {
        PMC_struct_val(SELF) = PMC_pmc_val(SELF) = NULL;
    }

    PMC* clone () {
        PMC* dest = pmc_new(INTERP, SELF->vtable->base_type);
        PMC_struct_val(dest) = PMC_struct_val(SELF);
        return dest;
    }

    void* get_pointer() {
        return PMC_struct_val(SELF);
    }

    void set_pointer(void* p) {
        PMC_struct_val(SELF) = p;
    }

    INTVAL is_same (PMC* value) {
        return SELF == value;
    }

    void set_same (PMC* value) {
        PMC_struct_val(SELF) = PMC_struct_val(value);
    }

    INTVAL is_equal (PMC* value) {
        return (SELF->vtable == value->vtable
                && PMC_struct_val(SELF) == PMC_struct_val(value));
    }

    INTVAL defined () {
        return PMC_struct_val(SELF) != NULL;
    }

    void* invoke (void * next) {
        Parrot_csub_t func =
        (Parrot_csub_t)D2FPTR(PMC_struct_val(SELF));
        func(INTERP, SELF);
        return next;
    }
}

/*

=head1 HISTORY

Initial revision by sean 2002/08/04.

=cut

*/

/*
 * Local variables:
 * c-indentation-style: bsd
 * c-basic-offset: 4
 * indent-tabs-mode: nil
 * End:
 *
 * vim: expandtab shiftwidth=4:
*/
